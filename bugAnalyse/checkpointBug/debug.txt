Loading pipeline components...:   0%|          | 0/5 [00:00<?, ?it/s]The config attributes {'pooled_projection_dim': 768} were passed to QwenImageTransformer2DModel, but are not expected and will be ignored. Please verify your config.json configuration file.

Loading checkpoint shards:   0%|          | 0/9 [00:00<?, ?it/s][A
Loading checkpoint shards:  44%|████▍     | 4/9 [00:00<00:00, 35.03it/s][A
Loading checkpoint shards:  89%|████████▉ | 8/9 [00:00<00:00, 35.59it/s][ALoading checkpoint shards: 100%|██████████| 9/9 [00:00<00:00, 37.76it/s]
Loading pipeline components...:  20%|██        | 1/5 [00:00<00:01,  2.79it/s]
Loading checkpoint shards:   0%|          | 0/4 [00:00<?, ?it/s][A
Loading checkpoint shards:  50%|█████     | 2/4 [00:00<00:00, 17.31it/s][ALoading checkpoint shards: 100%|██████████| 4/4 [00:00<00:00, 29.32it/s]
Loading pipeline components...:  60%|██████    | 3/5 [00:00<00:00,  4.48it/s]Loading pipeline components...:  80%|████████  | 4/5 [00:00<00:00,  4.55it/s]Loading pipeline components...: 100%|██████████| 5/5 [00:00<00:00,  5.19it/s]
Fetching 9 files:   0%|          | 0/9 [00:00<?, ?it/s]Fetching 9 files: 100%|██████████| 9/9 [00:00<00:00, 10621.48it/s]
The config attributes {'pooled_projection_dim': 768} were passed to RegionalQwenImageTransformer, but are not expected and will be ignored. Please verify your config.json configuration file.
Loading checkpoint shards:   0%|          | 0/9 [00:00<?, ?it/s]Loading checkpoint shards:  44%|████▍     | 4/9 [00:00<00:00, 35.87it/s]Loading checkpoint shards:  89%|████████▉ | 8/9 [00:00<00:00, 36.34it/s]Loading checkpoint shards: 100%|██████████| 9/9 [00:00<00:00, 38.60it/s]
VAE 显存占用 (FP32): 0.23635575734078884 GB
Text Encoder 显存占用 (FP16): 15.445363998413086 GB
Transformer 显存占用 (FP32): 38.05458748340607 GB
🔍 提取的引号内容:
  [0] 'Qwen Coffee 😊 $2 per cup'
  [1] '通义千问'
  [2] 'π≈3.1415926-53589793-23846264-33832795-02384197'

📊 总 token 数: 111
🔤 前 20 个 tokens: ['A', 'Ġcoffee', 'Ġshop', 'Ġentrance', 'Ġfeatures', 'Ġa', 'Ġchalk', 'board', 'Ġsign', 'Ġreading', 'Ġ"', 'Q', 'wen', 'ĠCoffee', 'ĠðŁĺ', 'Ĭ', 'Ġ$', '2', 'Ġper', 'Ġcup', '",', 'Ġand', 'Ġa', 'Ġneon', 'Ġlight', 'Ġ', 'Ġdisplaying', 'Ġ"', 'éĢļ', 'ä¹ī', 'åįĥ', 'éĹ®', '".', 'ĠNext', 'Ġto', 'Ġit', 'Ġhangs', 'Ġa', 'Ġposter', 'Ġshowing', 'Ġa', 'Ġbeautiful', 'ĠChinese', 'Ġwoman', ',', 'Ġand', 'Ġbeneath', 'Ġthe', 'Ġposter', 'Ġis', 'Ġwritten', 'Ġ"', 'ÏĢ', 'âīĪ', '3', '.', '1', '4', '1', '5', '9', '2', '6', '-', '5', '3', '5', '8', '9', '7', '9', '3', '-', '2', '3', '8', '4', '6', '2', '6', '4', '-', '3', '3', '8', '3', '2', '7', '9', '5', '-', '0', '2', '3', '8', '4', '1', '9', '7', '".']

📌 引号内容在 tokenizer 中的位置:

--- 处理引号内容 [0]: 'Qwen Coffee 😊 $2 per cup' ---
  Tokenized 子串: ['Q', 'wen', 'ĠCoffee', 'ĠðŁĺ', 'Ĭ', 'Ġ$', '2', 'Ġper', 'Ġcup']
  Token IDs: [48, 16948, 26079, 26525, 232, 400, 17, 817, 10525]
  ✅ 匹配位置: 起始索引 = 11, 结束索引 = 19 (token 范围: [11:20])
  🔁 重建文本: 'Qwen Coffee 😊 $2 per cup'
  ✅ 匹配成功，token 位置: [11, 12, 13, 14, 15, 16, 17, 18, 19]
  🔄 从 tokens 重建: 'Qwen Coffee 😊 $2 per cup'

--- 处理引号内容 [1]: '通义千问' ---
  Tokenized 子串: ['éĢļ', 'ä¹ī', 'åįĥ', 'éĹ®']
  Token IDs: [31935, 64559, 99320, 56007]
  ✅ 匹配位置: 起始索引 = 28, 结束索引 = 31 (token 范围: [28:32])
  🔁 重建文本: '通义千问'
  ✅ 匹配成功，token 位置: [28, 29, 30, 31]
  🔄 从 tokens 重建: '通义千问'

--- 处理引号内容 [2]: 'π≈3.1415926-53589793-23846264-33832795-02384197' ---
  Tokenized 子串: ['ÏĢ', 'âīĪ', '3', '.', '1', '4', '1', '5', '9', '2', '6', '-', '5', '3', '5', '8', '9', '7', '9', '3', '-', '2', '3', '8', '4', '6', '2', '6', '4', '-', '3', '3', '8', '3', '2', '7', '9', '5', '-', '0', '2', '3', '8', '4', '1', '9', '7']
  Token IDs: [48245, 144540, 18, 13, 16, 19, 16, 20, 24, 17, 21, 12, 20, 18, 20, 23, 24, 22, 24, 18, 12, 17, 18, 23, 19, 21, 17, 21, 19, 12, 18, 18, 23, 18, 17, 22, 24, 20, 12, 15, 17, 18, 23, 19, 16, 24, 22]
  ✅ 匹配位置: 起始索引 = 52, 结束索引 = 98 (token 范围: [52:99])
  🔁 重建文本: 'π≈3.1415926-53589793-23846264-33832795-02384197'
  ✅ 匹配成功，token 位置: [52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98]
  🔄 从 tokens 重建: 'π≈3.1415926-53589793-23846264-33832795-02384197'

============================================================
✅ 每个引号内容在 token 序列中的位置集合：
============================================================

        引号内容: "Qwen Coffee 😊 $2 per cup"
        位置集合: [11, 12, 13, 14, 15, 16, 17, 18, 19]
        长度: 9 tokens
        

        引号内容: "通义千问"
        位置集合: [28, 29, 30, 31]
        长度: 4 tokens
        

        引号内容: "π≈3.1415926-53589793-23846264-33832795-02384197"
        位置集合: [52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98]
        长度: 47 tokens
        
🔗 引号内容对应的 token 位置: {'Qwen Coffee 😊 $2 per cup': [11, 12, 13, 14, 15, 16, 17, 18, 19], '通义千问': [28, 29, 30, 31], 'π≈3.1415926-53589793-23846264-33832795-02384197': [52, 53, 54, 55, 56, 57, 58, 59, 60, 61, 62, 63, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 95, 96, 97, 98]}
  0%|          | 0/50 [00:00<?, ?it/s]/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/functional.py:554: UserWarning: torch.meshgrid: in an upcoming release, it will be required to pass the indexing argument. (Triggered internally at /pytorch/aten/src/ATen/native/TensorShape.cpp:4322.)
  return _VF.meshgrid(tensors, **kwargs)  # type: ignore[attr-defined]
GPU memory before offload: 56.39 GB
offload models to cpu
GPU memory after offload: 52.86 GB
{'cross': [tensor([[[3.8417e-09, 2.1511e-16, 4.6621e-18,  ..., 1.0000e+00,
          2.3134e-35, 1.8264e-21],
         [2.1576e-17, 5.1722e-36, 0.0000e+00,  ..., 1.2639e-33,
          1.5407e-32, 5.3926e-32],
         [2.4098e-36, 1.0650e-23, 5.7838e-25,  ..., 2.0583e-33,
          0.0000e+00, 5.3779e-37],
         ...,
         [3.6429e-16, 1.0623e-09, 1.3248e-25,  ..., 1.2110e-21,
          7.5496e-32, 3.0568e-29],
         [1.0800e-11, 5.3644e-07, 2.5674e-15,  ..., 2.4178e-17,
          2.7142e-25, 1.3080e-23],
         [9.8012e-17, 7.1765e-13, 1.5280e-09,  ..., 8.9362e-20,
          5.9195e-24, 1.8459e-28]]], device='cuda:0', dtype=torch.bfloat16,
       grad_fn=<SoftmaxBackward0>)], 'self': []}
max_attention_per_index_fg: [tensor(0.0747, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0601, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.1592, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0038, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0232, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0698, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0293, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.2402, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0192, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0374, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.1113, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0654, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0374, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0092, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0298, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.1001, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0371, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0092, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0374, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0356, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0728, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.1504, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0649, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0018, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>)]
max_attention_per_index_bg: [tensor(0.0562, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0244, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0559, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.1592, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0339, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0272, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0023, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0488, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0391, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.1465, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0095, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.3867, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0161, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.1514, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0330, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0015, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0649, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0056, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0025, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0015, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0053, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0051, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0015, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0015, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0117, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0032, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0015, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0057, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0072, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0143, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0187, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0015, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0023, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0430, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0105, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0082, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0131, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0015, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0015, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0040, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0015, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0155, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0167, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0023, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.1504, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0084, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0030, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0042, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0023, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0036, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0015, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0381, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0015, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0488, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0023, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0032, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0015, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0032, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0032, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0128, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>)]
dist_x: [tensor(0.0247, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0256, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0269, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0309, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0245, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0320, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0322, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0253, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0300, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0270, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0320, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0270, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0320, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0309, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0332, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0258, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0237, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0300, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0320, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0245, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0277, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0320, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0284, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0269, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0309, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0265, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0304, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0288, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0300, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0258, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>)]
  0%|          | 0/50 [00:13<?, ?it/s]
dist_y: [tensor(0.0554, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0571, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0481, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0540, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0481, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0645, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0469, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0510, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0540, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0442, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0532, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0554, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0554, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0488, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0574, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0498, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0574, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0439, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0544, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0532, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0574, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0444, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0562, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0459, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0554, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0515, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0574, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0564, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0503, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0500, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0498, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0537, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0630, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0537, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0537, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0518, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0593, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0574, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>), tensor(0.0574, device='cuda:0', dtype=torch.bfloat16, grad_fn=<MeanBackward0>)]
Traceback (most recent call last):
  File "/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py", line 1168, in unpack_hook_with_error_cb
    return unpack_hook(holder)
  File "/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py", line 1150, in unpack_hook
    frame.check_recomputed_tensors_match(gid)
  File "/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py", line 864, in check_recomputed_tensors_match
    raise CheckpointError(
torch.utils.checkpoint.CheckpointError: torch.utils.checkpoint: A different number of tensors was saved during the original forward and recomputation.
Number of tensors saved during forward: 68
Number of tensors saved during recomputation: 65.

Tip: To see a more detailed error message, either pass `debug=True` to
`torch.utils.checkpoint.checkpoint(...)` or wrap the code block
with `with torch.utils.checkpoint.set_checkpoint_debug_enabled(True):` to
enable checkpoint‑debug mode globally.


The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py", line 124, in <module>
    image = pipe(
  File "/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py", line 958, in __call__
    latents = self._update_latent(latents=latents, loss=loss,
  File "/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py", line 460, in _update_latent
    grad_cond = torch.autograd.grad(loss.requires_grad_(True), [latents], retain_graph=True)[0]
  File "/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/autograd/__init__.py", line 503, in grad
    result = _engine_run_backward(
  File "/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/autograd/graph.py", line 829, in _engine_run_backward
    return Variable._execution_engine.run_backward(  # Calls into the C++ engine to run the backward pass
  File "/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py", line 1170, in unpack_hook_with_error_cb
    frame.unpack_error_cb(e)
  File "/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py", line 1028, in unpack_error_cb
    raise CheckpointError(
torch.utils.checkpoint.CheckpointError:  An error happened while unpacking tensors; dumping logs of latest computation
because you passed `debug=True` to `torch.utils.checkpoint.checkpoint()`.
Scroll all the way down for guidance on how to navigate these logs.

+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+
|        1. Stack traces of the operators that ran in the original forward     |
+------------------------------------------------------------------------------+

$1: bf16[1, 3072] = torch._ops.aten.silu.default($0)   (1 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::silu::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::silu(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::silu>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::silu::call(at::Tensor const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_silu(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2375:silu
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/activation.py:434:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/container.py:244:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:409:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$3: bf16[3072, 18432] = torch._ops.aten.t.default($2)   (2 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/container.py:244:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:409:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$5: bf16[1, 18432] = torch._ops.aten.addmm.default($4, $1, $3)   (3 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/container.py:244:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:409:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$6: bf16[1, 3072] = torch._ops.aten.silu.default($0)   (4 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::silu::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::silu(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::silu>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::silu::call(at::Tensor const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_silu(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2375:silu
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/activation.py:434:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/container.py:244:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:410:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$8: bf16[3072, 18432] = torch._ops.aten.t.default($7)   (5 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/container.py:244:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:410:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$10: bf16[1, 18432] = torch._ops.aten.addmm.default($9, $6, $8)   (6 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/container.py:244:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:410:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


['$11: bf16[1, 9216]', '$12: bf16[1, 9216]'] = torch._ops.aten.split.Tensor($5, 9216, -1)   (7 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::ADInplaceOrView::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::autograd::VariableType::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::call(at::Tensor const&, c10::SymInt, long)
??:0:at::native::chunk(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__chunk>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, long)
??:0:at::_ops::chunk::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_chunk(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:413:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


['$13: bf16[1, 9216]', '$14: bf16[1, 9216]'] = torch._ops.aten.split.Tensor($10, 9216, -1)   (8 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::ADInplaceOrView::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::autograd::VariableType::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::call(at::Tensor const&, c10::SymInt, long)
??:0:at::native::chunk(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__chunk>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, long)
??:0:at::_ops::chunk::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_chunk(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:414:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


('$16: bf16[1, 6032, 3072]', '$17: f32[1, 6032, 1]', '$18: f32[1, 6032, 1]') = torch._ops.aten.native_layer_norm.default($15, ['3072'], None, None, 1e-06)   (9 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:417:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


['$19: bf16[1, 3072]', '$20: bf16[1, 3072]', '$21: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($11, 3072, -1)   (10 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::ADInplaceOrView::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::autograd::VariableType::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::call(at::Tensor const&, c10::SymInt, long)
??:0:at::native::chunk(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__chunk>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, long)
??:0:at::_ops::chunk::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_chunk(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:392:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$22: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($20, 1)   (11 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$23: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($22, 1)   (12 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$24: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($16, $23)   (13 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$25: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($19, 1)   (14 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$26: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($24, $25)   (15 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$27: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($21, 1)   (16 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


('$29: bf16[1, 116, 3072]', '$30: f32[1, 116, 1]', '$31: f32[1, 116, 1]') = torch._ops.aten.native_layer_norm.default($28, ['3072'], None, None, 1e-06)   (17 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:421:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


['$32: bf16[1, 3072]', '$33: bf16[1, 3072]', '$34: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($13, 3072, -1)   (18 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::ADInplaceOrView::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::autograd::VariableType::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::call(at::Tensor const&, c10::SymInt, long)
??:0:at::native::chunk(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__chunk>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, long)
??:0:at::_ops::chunk::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_chunk(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:392:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$35: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($33, 1)   (19 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$36: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($35, 1)   (20 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$37: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($29, $36)   (21 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$38: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($32, 1)   (22 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$39: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($37, $38)   (23 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$40: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($34, 1)   (24 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$41: bf16[6032, 3072] = torch._ops.aten.view.default($26, ['6032', '3072'])   (25 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:97:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$43: bf16[3072, 3072] = torch._ops.aten.t.default($42)   (26 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:97:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$45: bf16[6032, 3072] = torch._ops.aten.addmm.default($44, $41, $43)   (27 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:97:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$46: bf16[1, 6032, 3072] = torch._ops.aten.view.default($45, ['1', '6032', '3072'])   (28 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:97:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$47: bf16[6032, 3072] = torch._ops.aten.view.default($26, ['6032', '3072'])   (29 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:98:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$49: bf16[3072, 3072] = torch._ops.aten.t.default($48)   (30 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:98:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$51: bf16[6032, 3072] = torch._ops.aten.addmm.default($50, $47, $49)   (31 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:98:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$52: bf16[1, 6032, 3072] = torch._ops.aten.view.default($51, ['1', '6032', '3072'])   (32 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:98:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$53: bf16[6032, 3072] = torch._ops.aten.view.default($26, ['6032', '3072'])   (33 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:99:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$55: bf16[3072, 3072] = torch._ops.aten.t.default($54)   (34 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:99:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$57: bf16[6032, 3072] = torch._ops.aten.addmm.default($56, $53, $55)   (35 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:99:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$58: bf16[1, 6032, 3072] = torch._ops.aten.view.default($57, ['1', '6032', '3072'])   (36 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:99:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$59: bf16[116, 3072] = torch._ops.aten.view.default($39, ['116', '3072'])   (37 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:102:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$61: bf16[3072, 3072] = torch._ops.aten.t.default($60)   (38 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:102:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$63: bf16[116, 3072] = torch._ops.aten.addmm.default($62, $59, $61)   (39 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:102:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$64: bf16[1, 116, 3072] = torch._ops.aten.view.default($63, ['1', '116', '3072'])   (40 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:102:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$65: bf16[116, 3072] = torch._ops.aten.view.default($39, ['116', '3072'])   (41 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:103:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$67: bf16[3072, 3072] = torch._ops.aten.t.default($66)   (42 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:103:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$69: bf16[116, 3072] = torch._ops.aten.addmm.default($68, $65, $67)   (43 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:103:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$70: bf16[1, 116, 3072] = torch._ops.aten.view.default($69, ['1', '116', '3072'])   (44 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:103:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$71: bf16[116, 3072] = torch._ops.aten.view.default($39, ['116', '3072'])   (45 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:104:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$73: bf16[3072, 3072] = torch._ops.aten.t.default($72)   (46 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:104:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$75: bf16[116, 3072] = torch._ops.aten.addmm.default($74, $71, $73)   (47 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:104:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$76: bf16[1, 116, 3072] = torch._ops.aten.view.default($75, ['1', '116', '3072'])   (48 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:104:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$77: bf16[1, 6032, 24, 128] = torch._ops.aten.view.default($46, ['1', '6032', '24', '128'])   (49 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
TensorShape.cpp:0:at::native::unflatten_impl(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>, std::optional<c10::ArrayRef<at::Dimname> >) [clone .isra.0]
??:0:at::native::unflatten_symint(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_int_unflatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unflatten_int::call(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unflatten(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_tensor.py:1433:unflatten
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:107:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$78: bf16[1, 6032, 24, 128] = torch._ops.aten.view.default($52, ['1', '6032', '24', '128'])   (50 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
TensorShape.cpp:0:at::native::unflatten_impl(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>, std::optional<c10::ArrayRef<at::Dimname> >) [clone .isra.0]
??:0:at::native::unflatten_symint(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_int_unflatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unflatten_int::call(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unflatten(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_tensor.py:1433:unflatten
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:108:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$79: bf16[1, 6032, 24, 128] = torch._ops.aten.view.default($58, ['1', '6032', '24', '128'])   (51 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
TensorShape.cpp:0:at::native::unflatten_impl(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>, std::optional<c10::ArrayRef<at::Dimname> >) [clone .isra.0]
??:0:at::native::unflatten_symint(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_int_unflatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unflatten_int::call(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unflatten(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_tensor.py:1433:unflatten
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:109:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$80: bf16[1, 116, 24, 128] = torch._ops.aten.view.default($64, ['1', '116', '24', '128'])   (52 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
TensorShape.cpp:0:at::native::unflatten_impl(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>, std::optional<c10::ArrayRef<at::Dimname> >) [clone .isra.0]
??:0:at::native::unflatten_symint(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_int_unflatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unflatten_int::call(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unflatten(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_tensor.py:1433:unflatten
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:111:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$81: bf16[1, 116, 24, 128] = torch._ops.aten.view.default($70, ['1', '116', '24', '128'])   (53 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
TensorShape.cpp:0:at::native::unflatten_impl(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>, std::optional<c10::ArrayRef<at::Dimname> >) [clone .isra.0]
??:0:at::native::unflatten_symint(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_int_unflatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unflatten_int::call(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unflatten(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_tensor.py:1433:unflatten
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:112:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$82: bf16[1, 116, 24, 128] = torch._ops.aten.view.default($76, ['1', '116', '24', '128'])   (54 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
TensorShape.cpp:0:at::native::unflatten_impl(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>, std::optional<c10::ArrayRef<at::Dimname> >) [clone .isra.0]
??:0:at::native::unflatten_symint(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_int_unflatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unflatten_int::call(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unflatten(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_tensor.py:1433:unflatten
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:113:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$83: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($77, dtype=torch.float32)   (55 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$84: f32[1, 6032, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($83, 2)   (56 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$85: f32[1, 6032, 24, 1] = torch._ops.aten.mean.dim($84, ['-1'], True)   (57 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mean_dim(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>), &torch::autograd::VariableType::(anonymous namespace)::mean_dim>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::call(at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mean(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$86: f32[1, 6032, 24, 1] = torch._ops.aten.add.Tensor($85, 1e-06)   (58 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$87: f32[1, 6032, 24, 1] = torch._ops.aten.rsqrt.default($86)   (59 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$88: f32[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($77, $87)   (60 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$89: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($88, dtype=torch.bfloat16)   (61 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:561:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$91: bf16[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($89, $90)   (62 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:562:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$92: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($78, dtype=torch.float32)   (63 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$93: f32[1, 6032, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($92, 2)   (64 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$94: f32[1, 6032, 24, 1] = torch._ops.aten.mean.dim($93, ['-1'], True)   (65 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mean_dim(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>), &torch::autograd::VariableType::(anonymous namespace)::mean_dim>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::call(at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mean(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$95: f32[1, 6032, 24, 1] = torch._ops.aten.add.Tensor($94, 1e-06)   (66 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$96: f32[1, 6032, 24, 1] = torch._ops.aten.rsqrt.default($95)   (67 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$97: f32[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($78, $96)   (68 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$98: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($97, dtype=torch.bfloat16)   (69 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:561:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$100: bf16[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($98, $99)   (70 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:562:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$101: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($80, dtype=torch.float32)   (71 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$102: f32[1, 116, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($101, 2)   (72 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$103: f32[1, 116, 24, 1] = torch._ops.aten.mean.dim($102, ['-1'], True)   (73 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mean_dim(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>), &torch::autograd::VariableType::(anonymous namespace)::mean_dim>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::call(at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mean(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$104: f32[1, 116, 24, 1] = torch._ops.aten.add.Tensor($103, 1e-06)   (74 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$105: f32[1, 116, 24, 1] = torch._ops.aten.rsqrt.default($104)   (75 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$106: f32[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($80, $105)   (76 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$107: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($106, dtype=torch.bfloat16)   (77 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:561:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$109: bf16[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($107, $108)   (78 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:562:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$110: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($81, dtype=torch.float32)   (79 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$111: f32[1, 116, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($110, 2)   (80 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$112: f32[1, 116, 24, 1] = torch._ops.aten.mean.dim($111, ['-1'], True)   (81 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mean_dim(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>), &torch::autograd::VariableType::(anonymous namespace)::mean_dim>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::call(at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mean(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$113: f32[1, 116, 24, 1] = torch._ops.aten.add.Tensor($112, 1e-06)   (82 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$114: f32[1, 116, 24, 1] = torch._ops.aten.rsqrt.default($113)   (83 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$115: f32[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($81, $114)   (84 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$116: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($115, dtype=torch.bfloat16)   (85 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:561:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$118: bf16[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($116, $117)   (86 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:562:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$119: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($91, dtype=torch.float32)   (87 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to_type(_object*, c10::ScalarType, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_float(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$120: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view.default($119, ['1', '6032', '24', '-1', '2'])   (88 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_reshape(_object*, _object*, _object*)
:0:cfunction_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$121: c64[1, 6032, 24, 64] = torch._ops.aten.view_as_complex.default($120)   (89 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::call(at::Tensor const&)
python_torch_functions_0.cpp:0:torch::autograd::THPVariable_view_as_complex(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$123: c64[6032, 1, 64] = torch._ops.aten.unsqueeze.default($122, 1)   (90 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:58:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$124: c64[1, 6032, 24, 64] = torch._ops.aten.mul.Tensor($121, $123)   (91 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$125: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view_as_real.default($124)   (92 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_view_as_real(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$126: f32[1, 6032, 24, 128] = torch._ops.aten.view.default($125, ['1', '6032', '24', '128'])   (93 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::flatten(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_using_ints_flatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::flatten_using_ints::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_flatten(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$127: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($126, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))   (94 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_layout_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::type_as(at::Tensor const&, at::Tensor const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__type_as>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::type_as::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_type_as(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:61:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$128: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($100, dtype=torch.float32)   (95 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to_type(_object*, c10::ScalarType, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_float(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$129: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view.default($128, ['1', '6032', '24', '-1', '2'])   (96 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_reshape(_object*, _object*, _object*)
:0:cfunction_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$130: c64[1, 6032, 24, 64] = torch._ops.aten.view_as_complex.default($129)   (97 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::call(at::Tensor const&)
python_torch_functions_0.cpp:0:torch::autograd::THPVariable_view_as_complex(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$131: c64[6032, 1, 64] = torch._ops.aten.unsqueeze.default($122, 1)   (98 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:58:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$132: c64[1, 6032, 24, 64] = torch._ops.aten.mul.Tensor($130, $131)   (99 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$133: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view_as_real.default($132)   (100 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_view_as_real(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$134: f32[1, 6032, 24, 128] = torch._ops.aten.view.default($133, ['1', '6032', '24', '128'])   (101 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::flatten(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_using_ints_flatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::flatten_using_ints::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_flatten(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$135: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($134, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))   (102 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_layout_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::type_as(at::Tensor const&, at::Tensor const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__type_as>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::type_as::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_type_as(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:61:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$136: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($109, dtype=torch.float32)   (103 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to_type(_object*, c10::ScalarType, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_float(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$137: f32[1, 116, 24, 64, 2] = torch._ops.aten.view.default($136, ['1', '116', '24', '-1', '2'])   (104 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_reshape(_object*, _object*, _object*)
:0:cfunction_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$138: c64[1, 116, 24, 64] = torch._ops.aten.view_as_complex.default($137)   (105 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::call(at::Tensor const&)
python_torch_functions_0.cpp:0:torch::autograd::THPVariable_view_as_complex(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$140: c64[116, 1, 64] = torch._ops.aten.unsqueeze.default($139, 1)   (106 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:58:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$141: c64[1, 116, 24, 64] = torch._ops.aten.mul.Tensor($138, $140)   (107 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$142: f32[1, 116, 24, 64, 2] = torch._ops.aten.view_as_real.default($141)   (108 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_view_as_real(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$143: f32[1, 116, 24, 128] = torch._ops.aten.view.default($142, ['1', '116', '24', '128'])   (109 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::flatten(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_using_ints_flatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::flatten_using_ints::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_flatten(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$144: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($143, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))   (110 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_layout_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::type_as(at::Tensor const&, at::Tensor const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__type_as>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::type_as::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_type_as(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:61:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$145: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($118, dtype=torch.float32)   (111 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to_type(_object*, c10::ScalarType, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_float(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$146: f32[1, 116, 24, 64, 2] = torch._ops.aten.view.default($145, ['1', '116', '24', '-1', '2'])   (112 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_reshape(_object*, _object*, _object*)
:0:cfunction_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$147: c64[1, 116, 24, 64] = torch._ops.aten.view_as_complex.default($146)   (113 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::call(at::Tensor const&)
python_torch_functions_0.cpp:0:torch::autograd::THPVariable_view_as_complex(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$148: c64[116, 1, 64] = torch._ops.aten.unsqueeze.default($139, 1)   (114 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:58:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$149: c64[1, 116, 24, 64] = torch._ops.aten.mul.Tensor($147, $148)   (115 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$150: f32[1, 116, 24, 64, 2] = torch._ops.aten.view_as_real.default($149)   (116 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_view_as_real(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$151: f32[1, 116, 24, 128] = torch._ops.aten.view.default($150, ['1', '116', '24', '128'])   (117 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::flatten(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_using_ints_flatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::flatten_using_ints::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_flatten(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$152: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($151, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))   (118 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_layout_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::type_as(at::Tensor const&, at::Tensor const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__type_as>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::type_as::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_type_as(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:61:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$153: bf16[1, 6148, 24, 128] = torch._ops.aten.cat.default(['$144', '$127'], 1)   (119 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::cat(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long), &torch::autograd::VariableType::(anonymous namespace)::cat>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_cat(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:135:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$154: bf16[1, 6148, 24, 128] = torch._ops.aten.cat.default(['$152', '$135'], 1)   (120 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::cat(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long), &torch::autograd::VariableType::(anonymous namespace)::cat>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_cat(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:136:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$155: bf16[1, 6148, 24, 128] = torch._ops.aten.cat.default(['$82', '$79'], 1)   (121 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::cat(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long), &torch::autograd::VariableType::(anonymous namespace)::cat>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_cat(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:137:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$156: bf16[1, 24, 6148, 128] = torch._ops.aten.permute.default($153, ['0', '2', '1', '3'])   (122 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::ADInplaceOrView::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::autograd::VariableType::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<long>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::call(at::Tensor const&, c10::ArrayRef<long>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_permute(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:793:<genexpr>
??:0:_PyEval_EvalFrameDefault
:0:gen_iternext
:0:unpack_iterable
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:793:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$157: bf16[1, 24, 6148, 128] = torch._ops.aten.permute.default($154, ['0', '2', '1', '3'])   (123 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::ADInplaceOrView::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::autograd::VariableType::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<long>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::call(at::Tensor const&, c10::ArrayRef<long>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_permute(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:793:<genexpr>
??:0:_PyEval_EvalFrameDefault
:0:gen_iternext
:0:unpack_iterable
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:793:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$158: bf16[1, 24, 6148, 128] = torch._ops.aten.permute.default($155, ['0', '2', '1', '3'])   (124 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::ADInplaceOrView::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::autograd::VariableType::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<long>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::call(at::Tensor const&, c10::ArrayRef<long>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_permute(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:793:<genexpr>
??:0:_PyEval_EvalFrameDefault
:0:gen_iternext
:0:unpack_iterable
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:793:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


('$159: bf16[1, 24, 6148, 128]', '$160: f32[1, 24, 6148]', 'None', 'None', '6148', '6148', '$161: u64[2]', '$162: u64[]', '$163: bf16[0]') = torch._ops.aten._scaled_dot_product_flash_attention.default($156, $157, $158, scale=0.08838834764831843)   (125 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_scaled_dot_product_flash_attention::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>), &torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention>, std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_scaled_dot_product_flash_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
??:0:at::native::scaled_dot_product_attention(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__scaled_dot_product_attention>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::scaled_dot_product_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
python_nn_functions.cpp:0:torch::autograd::THPVariable_scaled_dot_product_attention(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:794:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$164: bf16[1, 6148, 24, 128] = torch._ops.aten.permute.default($159, ['0', '2', '1', '3'])   (126 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::ADInplaceOrView::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::autograd::VariableType::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<long>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::call(at::Tensor const&, c10::ArrayRef<long>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_permute(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:804:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$165: bf16[1, 6032, 116] = torch._ops.aten.empty.memory_format(['1', '6032', '116'], dtype=torch.bfloat16, device=device(type='cuda', index=0), pin_memory=False)   (127 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::empty_memory_format::call(c10::ArrayRef<c10::SymInt>, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, std::optional<c10::MemoryFormat>)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_empty(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:677:get_attention_scores
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:154:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$166: bf16[1, 3072, 116] = torch._ops.aten.transpose.int($39, -1, -2)   (128 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::transpose_int::redispatch(c10::DispatchKeySet, at::Tensor const&, long, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::transpose_int(c10::DispatchKeySet, at::Tensor const&, long, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, long), &torch::ADInplaceOrView::(anonymous namespace)::transpose_int>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, long)
??:0:at::_ops::transpose_int::redispatch(c10::DispatchKeySet, at::Tensor const&, long, long)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::transpose_int(c10::DispatchKeySet, at::Tensor const&, long, long)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, long), &torch::autograd::VariableType::(anonymous namespace)::transpose_int>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::transpose_int::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_transpose(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:688:get_attention_scores
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:154:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$167: bf16[1, 6032, 116] = torch._ops.aten.baddbmm.default($165, $26, $166, beta=0, alpha=0.08838834764831845)   (129 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::baddbmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::baddbmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::baddbmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::baddbmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_baddbmm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:685:get_attention_scores
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:154:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$168: bf16[1, 6032, 116] = torch._ops.aten._softmax.default($167, -1, False)   (130 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_softmax::redispatch(c10::DispatchKeySet, at::Tensor const&, long, bool)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_softmax(c10::DispatchKeySet, at::Tensor const&, long, bool)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, bool), &torch::autograd::VariableType::(anonymous namespace)::_softmax>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_softmax::call(at::Tensor const&, long, bool)
??:0:at::native::softmax(at::Tensor const&, long, std::optional<c10::ScalarType>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, std::optional<c10::ScalarType>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_int_softmax>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, std::optional<c10::ScalarType> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::ScalarType>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::ScalarType>)
??:0:at::_ops::softmax_int::call(at::Tensor const&, long, std::optional<c10::ScalarType>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_softmax(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:697:get_attention_scores
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:154:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$169: bf16[1, 6148, 3072] = torch._ops.aten.view.default($164, ['1', '6148', '3072'])   (131 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::flatten(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_using_ints_flatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::flatten_using_ints::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_flatten(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:160:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$170: bf16[1, 6148, 3072] = torch._ops.aten.slice.Tensor($169, 0, 0, 9223372036854775807)   (132 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::ADInplaceOrView::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
??:0:at::_ops::slice_Tensor::call(at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
:0:at::indexing::impl::applySlice(at::Tensor const&, long, c10::SymInt, c10::SymInt, c10::SymInt, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
:0:at::indexing::handleDimInMultiDimIndexing(at::Tensor const&, at::Tensor const&, at::indexing::TensorIndex const&, long*, long*, long, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
python_variable_indexing.cpp:0:torch::autograd::applySlicing(at::Tensor const&, _object*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<long> const&, long) [clone .constprop.0]
:0:torch::autograd::THPVariable_getitem(_object*, _object*)
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:164:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$171: bf16[1, 116, 3072] = torch._ops.aten.slice.Tensor($170, 1, 0, 116)   (133 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::ADInplaceOrView::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
??:0:at::_ops::slice_Tensor::call(at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
:0:at::indexing::impl::applySlice(at::Tensor const&, long, c10::SymInt, c10::SymInt, c10::SymInt, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
:0:at::indexing::handleDimInMultiDimIndexing(at::Tensor const&, at::Tensor const&, at::indexing::TensorIndex const&, long*, long*, long, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
python_variable_indexing.cpp:0:torch::autograd::applySlicing(at::Tensor const&, _object*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<long> const&, long) [clone .constprop.0]
:0:torch::autograd::THPVariable_getitem(_object*, _object*)
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:164:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$172: bf16[1, 116, 3072] = torch._ops.aten.slice.Tensor($171, 2, 0, 9223372036854775807)   (134 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::ADInplaceOrView::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
??:0:at::_ops::slice_Tensor::call(at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
:0:at::indexing::impl::applySlice(at::Tensor const&, long, c10::SymInt, c10::SymInt, c10::SymInt, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
:0:at::indexing::handleDimInMultiDimIndexing(at::Tensor const&, at::Tensor const&, at::indexing::TensorIndex const&, long*, long*, long, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
python_variable_indexing.cpp:0:torch::autograd::applySlicing(at::Tensor const&, _object*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<long> const&, long) [clone .constprop.0]
:0:torch::autograd::THPVariable_getitem(_object*, _object*)
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:164:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$173: bf16[1, 6148, 3072] = torch._ops.aten.slice.Tensor($169, 0, 0, 9223372036854775807)   (135 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::ADInplaceOrView::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
??:0:at::_ops::slice_Tensor::call(at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
:0:at::indexing::impl::applySlice(at::Tensor const&, long, c10::SymInt, c10::SymInt, c10::SymInt, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
:0:at::indexing::handleDimInMultiDimIndexing(at::Tensor const&, at::Tensor const&, at::indexing::TensorIndex const&, long*, long*, long, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
python_variable_indexing.cpp:0:torch::autograd::applySlicing(at::Tensor const&, _object*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<long> const&, long) [clone .constprop.0]
:0:torch::autograd::THPVariable_getitem(_object*, _object*)
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:165:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$174: bf16[1, 6032, 3072] = torch._ops.aten.slice.Tensor($173, 1, 116, 9223372036854775807)   (136 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::ADInplaceOrView::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
??:0:at::_ops::slice_Tensor::call(at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
:0:at::indexing::impl::applySlice(at::Tensor const&, long, c10::SymInt, c10::SymInt, c10::SymInt, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
:0:at::indexing::handleDimInMultiDimIndexing(at::Tensor const&, at::Tensor const&, at::indexing::TensorIndex const&, long*, long*, long, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
python_variable_indexing.cpp:0:torch::autograd::applySlicing(at::Tensor const&, _object*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<long> const&, long) [clone .constprop.0]
:0:torch::autograd::THPVariable_getitem(_object*, _object*)
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:165:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$175: bf16[1, 6032, 3072] = torch._ops.aten.slice.Tensor($174, 2, 0, 9223372036854775807)   (137 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::ADInplaceOrView::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
??:0:at::_ops::slice_Tensor::call(at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
:0:at::indexing::impl::applySlice(at::Tensor const&, long, c10::SymInt, c10::SymInt, c10::SymInt, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
:0:at::indexing::handleDimInMultiDimIndexing(at::Tensor const&, at::Tensor const&, at::indexing::TensorIndex const&, long*, long*, long, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
python_variable_indexing.cpp:0:torch::autograd::applySlicing(at::Tensor const&, _object*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<long> const&, long) [clone .constprop.0]
:0:torch::autograd::THPVariable_getitem(_object*, _object*)
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:165:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$176: bf16[6032, 3072] = torch._ops.aten.view.default($175, ['6032', '3072'])   (138 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:168:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$178: bf16[3072, 3072] = torch._ops.aten.t.default($177)   (139 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:168:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$180: bf16[6032, 3072] = torch._ops.aten.addmm.default($179, $176, $178)   (140 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:168:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$181: bf16[1, 6032, 3072] = torch._ops.aten.view.default($180, ['1', '6032', '3072'])   (141 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:168:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$182: bf16[116, 3072] = torch._ops.aten.view.default($172, ['116', '3072'])   (142 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:172:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$184: bf16[3072, 3072] = torch._ops.aten.t.default($183)   (143 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:172:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$186: bf16[116, 3072] = torch._ops.aten.addmm.default($185, $182, $184)   (144 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:172:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$187: bf16[1, 116, 3072] = torch._ops.aten.view.default($186, ['1', '116', '3072'])   (145 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:172:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$188: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($27, $181)   (146 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:452:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$189: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($15, $188)   (147 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:452:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$190: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($40, $187)   (148 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:453:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$191: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($28, $190)   (149 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:453:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


('$192: bf16[1, 6032, 3072]', '$193: f32[1, 6032, 1]', '$194: f32[1, 6032, 1]') = torch._ops.aten.native_layer_norm.default($189, ['3072'], None, None, 1e-06)   (150 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:458:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


['$195: bf16[1, 3072]', '$196: bf16[1, 3072]', '$197: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($12, 3072, -1)   (151 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::ADInplaceOrView::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::autograd::VariableType::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::call(at::Tensor const&, c10::SymInt, long)
??:0:at::native::chunk(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__chunk>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, long)
??:0:at::_ops::chunk::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_chunk(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:392:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$198: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($196, 1)   (152 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$199: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($198, 1)   (153 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$200: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($192, $199)   (154 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$201: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($195, 1)   (155 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$202: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($200, $201)   (156 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$203: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($197, 1)   (157 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$204: bf16[6032, 3072] = torch._ops.aten.view.default($202, ['6032', '3072'])   (158 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$206: bf16[3072, 12288] = torch._ops.aten.t.default($205)   (159 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$208: bf16[6032, 12288] = torch._ops.aten.addmm.default($207, $204, $206)   (160 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$209: bf16[1, 6032, 12288] = torch._ops.aten.view.default($208, ['1', '6032', '12288'])   (161 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$210: bf16[1, 6032, 12288] = torch._ops.aten.gelu.default($209, approximate='tanh')   (162 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::gelu::redispatch(c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::gelu(c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), &torch::autograd::VariableType::(anonymous namespace)::gelu>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> > > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
??:0:at::_ops::gelu::call(at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
python_nn_functions.cpp:0:torch::autograd::THPVariable_gelu(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:85:gelu
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:89:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$211: bf16[6032, 12288] = torch._ops.aten.view.default($210, ['6032', '12288'])   (163 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$213: bf16[12288, 3072] = torch._ops.aten.t.default($212)   (164 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$215: bf16[6032, 3072] = torch._ops.aten.addmm.default($214, $211, $213)   (165 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$216: bf16[1, 6032, 3072] = torch._ops.aten.view.default($215, ['1', '6032', '3072'])   (166 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$217: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($203, $216)   (167 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:461:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$218: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($189, $217)   (168 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:461:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


('$219: bf16[1, 116, 3072]', '$220: f32[1, 116, 1]', '$221: f32[1, 116, 1]') = torch._ops.aten.native_layer_norm.default($191, ['3072'], None, None, 1e-06)   (169 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:464:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


['$222: bf16[1, 3072]', '$223: bf16[1, 3072]', '$224: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($14, 3072, -1)   (170 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::ADInplaceOrView::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::autograd::VariableType::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::call(at::Tensor const&, c10::SymInt, long)
??:0:at::native::chunk(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__chunk>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, long)
??:0:at::_ops::chunk::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_chunk(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:392:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$225: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($223, 1)   (171 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$226: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($225, 1)   (172 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$227: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($219, $226)   (173 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$228: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($222, 1)   (174 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$229: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($227, $228)   (175 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$230: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($224, 1)   (176 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$231: bf16[116, 3072] = torch._ops.aten.view.default($229, ['116', '3072'])   (177 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$233: bf16[3072, 12288] = torch._ops.aten.t.default($232)   (178 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$235: bf16[116, 12288] = torch._ops.aten.addmm.default($234, $231, $233)   (179 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$236: bf16[1, 116, 12288] = torch._ops.aten.view.default($235, ['1', '116', '12288'])   (180 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$237: bf16[1, 116, 12288] = torch._ops.aten.gelu.default($236, approximate='tanh')   (181 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::gelu::redispatch(c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::gelu(c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), &torch::autograd::VariableType::(anonymous namespace)::gelu>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> > > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
??:0:at::_ops::gelu::call(at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
python_nn_functions.cpp:0:torch::autograd::THPVariable_gelu(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:85:gelu
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:89:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$238: bf16[116, 12288] = torch._ops.aten.view.default($237, ['116', '12288'])   (182 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$240: bf16[12288, 3072] = torch._ops.aten.t.default($239)   (183 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$242: bf16[116, 3072] = torch._ops.aten.addmm.default($241, $238, $240)   (184 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$243: bf16[1, 116, 3072] = torch._ops.aten.view.default($242, ['1', '116', '3072'])   (185 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$244: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($230, $243)   (186 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:467:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start


$245: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($191, $244)   (187 of 187 in original)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:467:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:495:checkpoint
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/modeling_utils.py:304:_gradient_checkpointing_func
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/QwenImageTransformerForRegional.py:181:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:906:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/boxLossControlStart.py:124:<module>
??:0:_PyEval_EvalFrameDefault
:0:_PyEval_Vector
??:0:PyEval_EvalCode
:0:run_eval_code_obj
:0:run_mod
:0:pyrun_file.cold
:0:_PyRun_SimpleFileObject.localalias
:0:_PyRun_AnyFileObject.localalias
:0:Py_RunMain.localalias
??:0:Py_BytesMain
??:0:__libc_start_main
??:0:_start



+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+
|        2. Stack traces of the operators that ran during recomputation        |
+------------------------------------------------------------------------------+

$1: bf16[1, 3072] = torch._ops.aten.silu.default($0)   (1 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::silu::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::silu(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::silu>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::silu::call(at::Tensor const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_silu(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2375:silu
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/activation.py:434:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/container.py:244:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:409:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$3: bf16[3072, 18432] = torch._ops.aten.t.default($2)   (2 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/container.py:244:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:409:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$5: bf16[1, 18432] = torch._ops.aten.addmm.default($4, $1, $3)   (3 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/container.py:244:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:409:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$6: bf16[1, 3072] = torch._ops.aten.silu.default($0)   (4 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::silu::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::silu(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::silu>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::silu::call(at::Tensor const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_silu(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2375:silu
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/activation.py:434:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/container.py:244:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:410:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$8: bf16[3072, 18432] = torch._ops.aten.t.default($7)   (5 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/container.py:244:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:410:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$10: bf16[1, 18432] = torch._ops.aten.addmm.default($9, $6, $8)   (6 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/container.py:244:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:410:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


['$11: bf16[1, 9216]', '$12: bf16[1, 9216]'] = torch._ops.aten.split.Tensor($5, 9216, -1)   (7 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::ADInplaceOrView::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::autograd::VariableType::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::call(at::Tensor const&, c10::SymInt, long)
??:0:at::native::chunk(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__chunk>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, long)
??:0:at::_ops::chunk::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_chunk(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:413:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


['$13: bf16[1, 9216]', '$14: bf16[1, 9216]'] = torch._ops.aten.split.Tensor($10, 9216, -1)   (8 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::ADInplaceOrView::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::autograd::VariableType::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::call(at::Tensor const&, c10::SymInt, long)
??:0:at::native::chunk(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__chunk>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, long)
??:0:at::_ops::chunk::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_chunk(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:414:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$16: bf16[1, 6032, 3072] = torch._ops.aten.detach.default($15)   (9 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:417:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$17: bf16[1, 6032, 3072] = torch._ops.aten.detach.default($16)   (10 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:417:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


('$18: bf16[1, 6032, 3072]', '$19: f32[1, 6032, 1]', '$20: f32[1, 6032, 1]') = torch._ops.aten.native_layer_norm.default($15, ['3072'], None, None, 1e-06)   (11 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:417:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


['$21: bf16[1, 3072]', '$22: bf16[1, 3072]', '$23: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($11, 3072, -1)   (12 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::ADInplaceOrView::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::autograd::VariableType::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::call(at::Tensor const&, c10::SymInt, long)
??:0:at::native::chunk(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__chunk>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, long)
??:0:at::_ops::chunk::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_chunk(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:392:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$24: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($22, 1)   (13 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$25: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($24, 1)   (14 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$26: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($18, $25)   (15 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$27: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($21, 1)   (16 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$28: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($26, $27)   (17 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$29: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($23, 1)   (18 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:418:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$31: bf16[1, 116, 3072] = torch._ops.aten.detach.default($30)   (19 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:421:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$32: bf16[1, 116, 3072] = torch._ops.aten.detach.default($31)   (20 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:421:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


('$33: bf16[1, 116, 3072]', '$34: f32[1, 116, 1]', '$35: f32[1, 116, 1]') = torch._ops.aten.native_layer_norm.default($30, ['3072'], None, None, 1e-06)   (21 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:421:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


['$36: bf16[1, 3072]', '$37: bf16[1, 3072]', '$38: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($13, 3072, -1)   (22 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::ADInplaceOrView::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::autograd::VariableType::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::call(at::Tensor const&, c10::SymInt, long)
??:0:at::native::chunk(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__chunk>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, long)
??:0:at::_ops::chunk::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_chunk(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:392:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$39: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($37, 1)   (23 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$40: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($39, 1)   (24 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$41: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($33, $40)   (25 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$42: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($36, 1)   (26 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$43: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($41, $42)   (27 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$44: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($38, 1)   (28 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:422:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$45: bf16[6032, 3072] = torch._ops.aten.view.default($28, ['6032', '3072'])   (29 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:97:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$47: bf16[3072, 3072] = torch._ops.aten.t.default($46)   (30 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:97:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$49: bf16[6032, 3072] = torch._ops.aten.addmm.default($48, $45, $47)   (31 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:97:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$50: bf16[1, 6032, 3072] = torch._ops.aten.view.default($49, ['1', '6032', '3072'])   (32 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:97:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$51: bf16[6032, 3072] = torch._ops.aten.view.default($28, ['6032', '3072'])   (33 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:98:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$53: bf16[3072, 3072] = torch._ops.aten.t.default($52)   (34 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:98:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$55: bf16[6032, 3072] = torch._ops.aten.addmm.default($54, $51, $53)   (35 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:98:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$56: bf16[1, 6032, 3072] = torch._ops.aten.view.default($55, ['1', '6032', '3072'])   (36 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:98:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$57: bf16[6032, 3072] = torch._ops.aten.view.default($28, ['6032', '3072'])   (37 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:99:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$59: bf16[3072, 3072] = torch._ops.aten.t.default($58)   (38 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:99:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$61: bf16[6032, 3072] = torch._ops.aten.addmm.default($60, $57, $59)   (39 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:99:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$62: bf16[1, 6032, 3072] = torch._ops.aten.view.default($61, ['1', '6032', '3072'])   (40 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:99:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$63: bf16[116, 3072] = torch._ops.aten.view.default($43, ['116', '3072'])   (41 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:102:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$65: bf16[3072, 3072] = torch._ops.aten.t.default($64)   (42 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:102:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$67: bf16[116, 3072] = torch._ops.aten.addmm.default($66, $63, $65)   (43 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:102:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$68: bf16[1, 116, 3072] = torch._ops.aten.view.default($67, ['1', '116', '3072'])   (44 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:102:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$69: bf16[116, 3072] = torch._ops.aten.view.default($43, ['116', '3072'])   (45 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:103:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$71: bf16[3072, 3072] = torch._ops.aten.t.default($70)   (46 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:103:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$73: bf16[116, 3072] = torch._ops.aten.addmm.default($72, $69, $71)   (47 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:103:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$74: bf16[1, 116, 3072] = torch._ops.aten.view.default($73, ['1', '116', '3072'])   (48 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:103:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$75: bf16[116, 3072] = torch._ops.aten.view.default($43, ['116', '3072'])   (49 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:104:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$77: bf16[3072, 3072] = torch._ops.aten.t.default($76)   (50 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:104:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$79: bf16[116, 3072] = torch._ops.aten.addmm.default($78, $75, $77)   (51 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:104:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$80: bf16[1, 116, 3072] = torch._ops.aten.view.default($79, ['1', '116', '3072'])   (52 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:104:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$81: bf16[1, 6032, 24, 128] = torch._ops.aten.view.default($50, ['1', '6032', '24', '128'])   (53 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
TensorShape.cpp:0:at::native::unflatten_impl(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>, std::optional<c10::ArrayRef<at::Dimname> >) [clone .isra.0]
??:0:at::native::unflatten_symint(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_int_unflatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unflatten_int::call(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unflatten(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_tensor.py:1433:unflatten
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:107:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$82: bf16[1, 6032, 24, 128] = torch._ops.aten.view.default($56, ['1', '6032', '24', '128'])   (54 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
TensorShape.cpp:0:at::native::unflatten_impl(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>, std::optional<c10::ArrayRef<at::Dimname> >) [clone .isra.0]
??:0:at::native::unflatten_symint(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_int_unflatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unflatten_int::call(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unflatten(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_tensor.py:1433:unflatten
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:108:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$83: bf16[1, 6032, 24, 128] = torch._ops.aten.view.default($62, ['1', '6032', '24', '128'])   (55 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
TensorShape.cpp:0:at::native::unflatten_impl(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>, std::optional<c10::ArrayRef<at::Dimname> >) [clone .isra.0]
??:0:at::native::unflatten_symint(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_int_unflatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unflatten_int::call(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unflatten(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_tensor.py:1433:unflatten
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:109:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$84: bf16[1, 116, 24, 128] = torch._ops.aten.view.default($68, ['1', '116', '24', '128'])   (56 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
TensorShape.cpp:0:at::native::unflatten_impl(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>, std::optional<c10::ArrayRef<at::Dimname> >) [clone .isra.0]
??:0:at::native::unflatten_symint(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_int_unflatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unflatten_int::call(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unflatten(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_tensor.py:1433:unflatten
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:111:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$85: bf16[1, 116, 24, 128] = torch._ops.aten.view.default($74, ['1', '116', '24', '128'])   (57 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
TensorShape.cpp:0:at::native::unflatten_impl(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>, std::optional<c10::ArrayRef<at::Dimname> >) [clone .isra.0]
??:0:at::native::unflatten_symint(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_int_unflatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unflatten_int::call(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unflatten(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_tensor.py:1433:unflatten
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:112:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$86: bf16[1, 116, 24, 128] = torch._ops.aten.view.default($80, ['1', '116', '24', '128'])   (58 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
TensorShape.cpp:0:at::native::unflatten_impl(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>, std::optional<c10::ArrayRef<at::Dimname> >) [clone .isra.0]
??:0:at::native::unflatten_symint(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_int_unflatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unflatten_int::call(at::Tensor const&, long, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unflatten(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_tensor.py:1433:unflatten
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:113:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$87: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($81, dtype=torch.float32)   (59 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$88: f32[1, 6032, 24, 128] = torch._ops.aten.detach.default($87)   (60 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$89: f32[1, 6032, 24, 128] = torch._ops.aten.detach.default($88)   (61 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$90: f32[1, 6032, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($87, 2)   (62 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$91: f32[1, 6032, 24, 1] = torch._ops.aten.mean.dim($90, ['-1'], True)   (63 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mean_dim(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>), &torch::autograd::VariableType::(anonymous namespace)::mean_dim>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::call(at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mean(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$92: f32[1, 6032, 24, 1] = torch._ops.aten.add.Tensor($91, 1e-06)   (64 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$93: f32[1, 6032, 24, 1] = torch._ops.aten.rsqrt.default($92)   (65 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$94: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($93)   (66 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$95: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($94)   (67 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$96: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($93)   (68 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$97: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($96)   (69 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$98: bf16[1, 6032, 24, 128] = torch._ops.aten.detach.default($81)   (70 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$99: bf16[1, 6032, 24, 128] = torch._ops.aten.detach.default($98)   (71 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$100: f32[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($81, $93)   (72 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$101: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($100, dtype=torch.bfloat16)   (73 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:561:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$103: bf16[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($101, $102)   (74 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:562:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:117:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$104: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($82, dtype=torch.float32)   (75 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$105: f32[1, 6032, 24, 128] = torch._ops.aten.detach.default($104)   (76 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$106: f32[1, 6032, 24, 128] = torch._ops.aten.detach.default($105)   (77 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$107: f32[1, 6032, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($104, 2)   (78 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$108: f32[1, 6032, 24, 1] = torch._ops.aten.mean.dim($107, ['-1'], True)   (79 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mean_dim(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>), &torch::autograd::VariableType::(anonymous namespace)::mean_dim>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::call(at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mean(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$109: f32[1, 6032, 24, 1] = torch._ops.aten.add.Tensor($108, 1e-06)   (80 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$110: f32[1, 6032, 24, 1] = torch._ops.aten.rsqrt.default($109)   (81 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$111: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($110)   (82 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$112: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($111)   (83 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$113: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($110)   (84 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$114: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($113)   (85 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$115: bf16[1, 6032, 24, 128] = torch._ops.aten.detach.default($82)   (86 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$116: bf16[1, 6032, 24, 128] = torch._ops.aten.detach.default($115)   (87 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$117: f32[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($82, $110)   (88 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$118: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($117, dtype=torch.bfloat16)   (89 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:561:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$120: bf16[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($118, $119)   (90 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:562:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:119:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$121: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($84, dtype=torch.float32)   (91 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$122: f32[1, 116, 24, 128] = torch._ops.aten.detach.default($121)   (92 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$123: f32[1, 116, 24, 128] = torch._ops.aten.detach.default($122)   (93 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$124: f32[1, 116, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($121, 2)   (94 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$125: f32[1, 116, 24, 1] = torch._ops.aten.mean.dim($124, ['-1'], True)   (95 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mean_dim(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>), &torch::autograd::VariableType::(anonymous namespace)::mean_dim>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::call(at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mean(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$126: f32[1, 116, 24, 1] = torch._ops.aten.add.Tensor($125, 1e-06)   (96 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$127: f32[1, 116, 24, 1] = torch._ops.aten.rsqrt.default($126)   (97 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$128: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($127)   (98 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$129: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($128)   (99 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$130: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($127)   (100 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$131: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($130)   (101 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$132: bf16[1, 116, 24, 128] = torch._ops.aten.detach.default($84)   (102 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$133: bf16[1, 116, 24, 128] = torch._ops.aten.detach.default($132)   (103 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$134: f32[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($84, $127)   (104 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$135: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($134, dtype=torch.bfloat16)   (105 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:561:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$137: bf16[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($135, $136)   (106 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:562:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:121:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$138: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($85, dtype=torch.float32)   (107 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$139: f32[1, 116, 24, 128] = torch._ops.aten.detach.default($138)   (108 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$140: f32[1, 116, 24, 128] = torch._ops.aten.detach.default($139)   (109 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$141: f32[1, 116, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($138, 2)   (110 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar(c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::pow_Tensor_Scalar>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::Scalar const&)
??:0:at::_ops::pow_Tensor_Scalar::call(at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_pow(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$142: f32[1, 116, 24, 1] = torch._ops.aten.mean.dim($141, ['-1'], True)   (111 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mean_dim(c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>), &torch::autograd::VariableType::(anonymous namespace)::mean_dim>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::mean_dim::call(at::Tensor const&, c10::OptionalArrayRef<long>, bool, std::optional<c10::ScalarType>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mean(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:555:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$143: f32[1, 116, 24, 1] = torch._ops.aten.add.Tensor($142, 1e-06)   (112 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$144: f32[1, 116, 24, 1] = torch._ops.aten.rsqrt.default($143)   (113 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$145: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($144)   (114 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$146: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($145)   (115 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::rsqrt(c10::DispatchKeySet, at::Tensor const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::rsqrt>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::rsqrt::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_rsqrt(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$147: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($144)   (116 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$148: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($147)   (117 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$149: bf16[1, 116, 24, 128] = torch._ops.aten.detach.default($85)   (118 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$150: bf16[1, 116, 24, 128] = torch._ops.aten.detach.default($149)   (119 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$151: f32[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($85, $144)   (120 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:556:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$152: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($151, dtype=torch.bfloat16)   (121 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::dispatch_to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:561:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$154: bf16[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($152, $153)   (122 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/normalization.py:562:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:123:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$155: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($103, dtype=torch.float32)   (123 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to_type(_object*, c10::ScalarType, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_float(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$156: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view.default($155, ['1', '6032', '24', '-1', '2'])   (124 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_reshape(_object*, _object*, _object*)
:0:cfunction_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$157: c64[1, 6032, 24, 64] = torch._ops.aten.view_as_complex.default($156)   (125 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::call(at::Tensor const&)
python_torch_functions_0.cpp:0:torch::autograd::THPVariable_view_as_complex(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$159: c64[6032, 1, 64] = torch._ops.aten.unsqueeze.default($158, 1)   (126 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:58:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$160: c64[1, 6032, 24, 64] = torch._ops.aten.mul.Tensor($157, $159)   (127 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$161: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view_as_real.default($160)   (128 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_view_as_real(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$162: f32[1, 6032, 24, 128] = torch._ops.aten.view.default($161, ['1', '6032', '24', '128'])   (129 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::flatten(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_using_ints_flatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::flatten_using_ints::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_flatten(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$163: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($162, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))   (130 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_layout_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::type_as(at::Tensor const&, at::Tensor const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__type_as>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::type_as::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_type_as(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:61:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:128:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$164: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($120, dtype=torch.float32)   (131 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to_type(_object*, c10::ScalarType, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_float(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$165: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view.default($164, ['1', '6032', '24', '-1', '2'])   (132 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_reshape(_object*, _object*, _object*)
:0:cfunction_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$166: c64[1, 6032, 24, 64] = torch._ops.aten.view_as_complex.default($165)   (133 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::call(at::Tensor const&)
python_torch_functions_0.cpp:0:torch::autograd::THPVariable_view_as_complex(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$167: c64[6032, 1, 64] = torch._ops.aten.unsqueeze.default($158, 1)   (134 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:58:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$168: c64[1, 6032, 24, 64] = torch._ops.aten.mul.Tensor($166, $167)   (135 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$169: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view_as_real.default($168)   (136 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_view_as_real(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$170: f32[1, 6032, 24, 128] = torch._ops.aten.view.default($169, ['1', '6032', '24', '128'])   (137 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::flatten(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_using_ints_flatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::flatten_using_ints::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_flatten(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$171: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($170, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))   (138 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_layout_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::type_as(at::Tensor const&, at::Tensor const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__type_as>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::type_as::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_type_as(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:61:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:129:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$172: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($137, dtype=torch.float32)   (139 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to_type(_object*, c10::ScalarType, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_float(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$173: f32[1, 116, 24, 64, 2] = torch._ops.aten.view.default($172, ['1', '116', '24', '-1', '2'])   (140 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_reshape(_object*, _object*, _object*)
:0:cfunction_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$174: c64[1, 116, 24, 64] = torch._ops.aten.view_as_complex.default($173)   (141 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::call(at::Tensor const&)
python_torch_functions_0.cpp:0:torch::autograd::THPVariable_view_as_complex(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$176: c64[116, 1, 64] = torch._ops.aten.unsqueeze.default($175, 1)   (142 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:58:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$177: c64[1, 116, 24, 64] = torch._ops.aten.mul.Tensor($174, $176)   (143 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$178: f32[1, 116, 24, 64, 2] = torch._ops.aten.view_as_real.default($177)   (144 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_view_as_real(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$179: f32[1, 116, 24, 128] = torch._ops.aten.view.default($178, ['1', '116', '24', '128'])   (145 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::flatten(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_using_ints_flatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::flatten_using_ints::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_flatten(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$180: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($179, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))   (146 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_layout_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::type_as(at::Tensor const&, at::Tensor const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__type_as>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::type_as::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_type_as(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:61:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:130:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$181: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($154, dtype=torch.float32)   (147 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype::call(at::Tensor const&, c10::ScalarType, bool, bool, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_to_type(_object*, c10::ScalarType, std::optional<c10::MemoryFormat>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_float(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$182: f32[1, 116, 24, 64, 2] = torch._ops.aten.view.default($181, ['1', '116', '24', '-1', '2'])   (148 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_reshape(_object*, _object*, _object*)
:0:cfunction_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$183: c64[1, 116, 24, 64] = torch._ops.aten.view_as_complex.default($182)   (149 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_complex(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_complex>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_complex::call(at::Tensor const&)
python_torch_functions_0.cpp:0:torch::autograd::THPVariable_view_as_complex(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:57:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$184: c64[116, 1, 64] = torch._ops.aten.unsqueeze.default($175, 1)   (150 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:58:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$185: c64[1, 116, 24, 64] = torch._ops.aten.mul.Tensor($183, $184)   (151 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$186: f32[1, 116, 24, 64, 2] = torch._ops.aten.view_as_real.default($185)   (152 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view_as_real(c10::DispatchKeySet, at::Tensor const&)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::view_as_real>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::view_as_real::call(at::Tensor const&)
python_torch_functions_1.cpp:0:torch::autograd::THPVariable_view_as_real(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$187: f32[1, 116, 24, 128] = torch._ops.aten.view.default($186, ['1', '116', '24', '128'])   (153 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::flatten(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_using_ints_flatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::flatten_using_ints::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_flatten(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:59:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$188: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($187, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))   (154 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::redispatch(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_to_copy(c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>), &torch::autograd::VariableType::(anonymous namespace)::_to_copy>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_to_copy::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::to(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_dtype_layout_to>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::to_dtype_layout::call(at::Tensor const&, std::optional<c10::ScalarType>, std::optional<c10::Layout>, std::optional<c10::Device>, std::optional<bool>, bool, bool, std::optional<c10::MemoryFormat>)
??:0:at::native::type_as(at::Tensor const&, at::Tensor const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__type_as>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::type_as::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_type_as(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:61:apply_rotary_emb_qwen
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:131:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$189: bf16[1, 6148, 24, 128] = torch._ops.aten.cat.default(['$180', '$163'], 1)   (155 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::cat(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long), &torch::autograd::VariableType::(anonymous namespace)::cat>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_cat(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:135:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$190: bf16[1, 6148, 24, 128] = torch._ops.aten.cat.default(['$188', '$171'], 1)   (156 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::cat(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long), &torch::autograd::VariableType::(anonymous namespace)::cat>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_cat(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:136:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$191: bf16[1, 6148, 24, 128] = torch._ops.aten.cat.default(['$86', '$83'], 1)   (157 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::cat::redispatch(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::cat(c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long), &torch::autograd::VariableType::(anonymous namespace)::cat>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, c10::IListRef<at::Tensor> const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::cat::call(c10::IListRef<at::Tensor> const&, long)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_cat(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:137:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$192: bf16[1, 24, 6148, 128] = torch._ops.aten.permute.default($189, ['0', '2', '1', '3'])   (158 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::ADInplaceOrView::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::autograd::VariableType::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<long>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::call(at::Tensor const&, c10::ArrayRef<long>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_permute(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:793:<genexpr>
??:0:_PyEval_EvalFrameDefault
:0:gen_iternext
:0:unpack_iterable
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:793:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$193: bf16[1, 24, 6148, 128] = torch._ops.aten.permute.default($190, ['0', '2', '1', '3'])   (159 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::ADInplaceOrView::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::autograd::VariableType::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<long>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::call(at::Tensor const&, c10::ArrayRef<long>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_permute(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:793:<genexpr>
??:0:_PyEval_EvalFrameDefault
:0:gen_iternext
:0:unpack_iterable
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:793:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$194: bf16[1, 24, 6148, 128] = torch._ops.aten.permute.default($191, ['0', '2', '1', '3'])   (160 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::ADInplaceOrView::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::autograd::VariableType::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<long>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::call(at::Tensor const&, c10::ArrayRef<long>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_permute(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:793:<genexpr>
??:0:_PyEval_EvalFrameDefault
:0:gen_iternext
:0:unpack_iterable
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:793:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$195: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($193)   (161 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>), &torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention>, std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_scaled_dot_product_flash_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
??:0:at::native::scaled_dot_product_attention(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__scaled_dot_product_attention>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::scaled_dot_product_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
python_nn_functions.cpp:0:torch::autograd::THPVariable_scaled_dot_product_attention(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:794:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$196: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($195)   (162 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>), &torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention>, std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_scaled_dot_product_flash_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
??:0:at::native::scaled_dot_product_attention(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__scaled_dot_product_attention>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::scaled_dot_product_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
python_nn_functions.cpp:0:torch::autograd::THPVariable_scaled_dot_product_attention(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:794:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$197: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($192)   (163 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>), &torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention>, std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_scaled_dot_product_flash_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
??:0:at::native::scaled_dot_product_attention(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__scaled_dot_product_attention>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::scaled_dot_product_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
python_nn_functions.cpp:0:torch::autograd::THPVariable_scaled_dot_product_attention(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:794:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$198: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($197)   (164 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>), &torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention>, std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_scaled_dot_product_flash_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
??:0:at::native::scaled_dot_product_attention(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__scaled_dot_product_attention>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::scaled_dot_product_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
python_nn_functions.cpp:0:torch::autograd::THPVariable_scaled_dot_product_attention(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:794:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$199: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($194)   (165 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>), &torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention>, std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_scaled_dot_product_flash_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
??:0:at::native::scaled_dot_product_attention(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__scaled_dot_product_attention>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::scaled_dot_product_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
python_nn_functions.cpp:0:torch::autograd::THPVariable_scaled_dot_product_attention(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:794:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$200: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($199)   (166 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>), &torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention>, std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_scaled_dot_product_flash_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
??:0:at::native::scaled_dot_product_attention(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__scaled_dot_product_attention>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::scaled_dot_product_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
python_nn_functions.cpp:0:torch::autograd::THPVariable_scaled_dot_product_attention(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:794:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


('$201: bf16[1, 24, 6148, 128]', '$202: f32[1, 24, 6148]', 'None', 'None', '6148', '6148', '$203: u64[2]', '$204: u64[]', '$205: bf16[0]') = torch._ops.aten._scaled_dot_product_flash_attention.default($192, $193, $194, scale=0.08838834764831843)   (167 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_scaled_dot_product_flash_attention::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>), &torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention>, std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_scaled_dot_product_flash_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
??:0:at::native::scaled_dot_product_attention(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__scaled_dot_product_attention>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::scaled_dot_product_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
python_nn_functions.cpp:0:torch::autograd::THPVariable_scaled_dot_product_attention(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:794:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$206: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($201)   (168 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>), &torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention>, std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_scaled_dot_product_flash_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
??:0:at::native::scaled_dot_product_attention(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__scaled_dot_product_attention>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::scaled_dot_product_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
python_nn_functions.cpp:0:torch::autograd::THPVariable_scaled_dot_product_attention(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:794:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$207: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($206)   (169 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>), &torch::autograd::VariableType::(anonymous namespace)::_scaled_dot_product_flash_attention>, std::tuple<at::Tensor, at::Tensor, at::Tensor, at::Tensor, c10::SymInt, c10::SymInt, at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::_scaled_dot_product_flash_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, double, bool, bool, std::optional<double>)
??:0:at::native::scaled_dot_product_attention(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__scaled_dot_product_attention>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::scaled_dot_product_attention::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&, double, bool, std::optional<double>, bool)
python_nn_functions.cpp:0:torch::autograd::THPVariable_scaled_dot_product_attention(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:794:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$208: bf16[1, 6148, 24, 128] = torch._ops.aten.permute.default($201, ['0', '2', '1', '3'])   (170 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::ADInplaceOrView::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::permute(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>), &torch::autograd::VariableType::(anonymous namespace)::permute>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<long>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<long>)
??:0:at::_ops::permute::call(at::Tensor const&, c10::ArrayRef<long>)
python_variable_methods.cpp:0:torch::autograd::THPVariable_permute(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:804:_native_attention
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_dispatch.py:253:dispatch_attention_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:140:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$209: bf16[1, 6148, 3072] = torch._ops.aten.view.default($208, ['1', '6148', '3072'])   (171 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::flatten(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd_using_ints_flatten>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::flatten_using_ints::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_flatten(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:160:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$210: bf16[1, 6148, 3072] = torch._ops.aten.slice.Tensor($209, 0, 0, 9223372036854775807)   (172 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::ADInplaceOrView::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
??:0:at::_ops::slice_Tensor::call(at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
:0:at::indexing::impl::applySlice(at::Tensor const&, long, c10::SymInt, c10::SymInt, c10::SymInt, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
:0:at::indexing::handleDimInMultiDimIndexing(at::Tensor const&, at::Tensor const&, at::indexing::TensorIndex const&, long*, long*, long, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
python_variable_indexing.cpp:0:torch::autograd::applySlicing(at::Tensor const&, _object*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<long> const&, long) [clone .constprop.0]
:0:torch::autograd::THPVariable_getitem(_object*, _object*)
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:164:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$211: bf16[1, 116, 3072] = torch._ops.aten.slice.Tensor($210, 1, 0, 116)   (173 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::ADInplaceOrView::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
??:0:at::_ops::slice_Tensor::call(at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
:0:at::indexing::impl::applySlice(at::Tensor const&, long, c10::SymInt, c10::SymInt, c10::SymInt, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
:0:at::indexing::handleDimInMultiDimIndexing(at::Tensor const&, at::Tensor const&, at::indexing::TensorIndex const&, long*, long*, long, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
python_variable_indexing.cpp:0:torch::autograd::applySlicing(at::Tensor const&, _object*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<long> const&, long) [clone .constprop.0]
:0:torch::autograd::THPVariable_getitem(_object*, _object*)
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:164:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$212: bf16[1, 116, 3072] = torch._ops.aten.slice.Tensor($211, 2, 0, 9223372036854775807)   (174 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::ADInplaceOrView::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
??:0:at::_ops::slice_Tensor::call(at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
:0:at::indexing::impl::applySlice(at::Tensor const&, long, c10::SymInt, c10::SymInt, c10::SymInt, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
:0:at::indexing::handleDimInMultiDimIndexing(at::Tensor const&, at::Tensor const&, at::indexing::TensorIndex const&, long*, long*, long, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
python_variable_indexing.cpp:0:torch::autograd::applySlicing(at::Tensor const&, _object*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<long> const&, long) [clone .constprop.0]
:0:torch::autograd::THPVariable_getitem(_object*, _object*)
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:164:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$213: bf16[1, 6148, 3072] = torch._ops.aten.slice.Tensor($209, 0, 0, 9223372036854775807)   (175 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::ADInplaceOrView::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
??:0:at::_ops::slice_Tensor::call(at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
:0:at::indexing::impl::applySlice(at::Tensor const&, long, c10::SymInt, c10::SymInt, c10::SymInt, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
:0:at::indexing::handleDimInMultiDimIndexing(at::Tensor const&, at::Tensor const&, at::indexing::TensorIndex const&, long*, long*, long, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
python_variable_indexing.cpp:0:torch::autograd::applySlicing(at::Tensor const&, _object*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<long> const&, long) [clone .constprop.0]
:0:torch::autograd::THPVariable_getitem(_object*, _object*)
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:165:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$214: bf16[1, 6032, 3072] = torch._ops.aten.slice.Tensor($213, 1, 116, 9223372036854775807)   (176 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::ADInplaceOrView::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
??:0:at::_ops::slice_Tensor::call(at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
:0:at::indexing::impl::applySlice(at::Tensor const&, long, c10::SymInt, c10::SymInt, c10::SymInt, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
:0:at::indexing::handleDimInMultiDimIndexing(at::Tensor const&, at::Tensor const&, at::indexing::TensorIndex const&, long*, long*, long, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
python_variable_indexing.cpp:0:torch::autograd::applySlicing(at::Tensor const&, _object*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<long> const&, long) [clone .constprop.0]
:0:torch::autograd::THPVariable_getitem(_object*, _object*)
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:165:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$215: bf16[1, 6032, 3072] = torch._ops.aten.slice.Tensor($214, 2, 0, 9223372036854775807)   (177 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::ADInplaceOrView::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
Operators_4.cpp:0:at::Tensor c10::Dispatcher::redispatch<at::Tensor, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt>(c10::TypedOperatorHandle<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)> const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt) const [clone .isra.0]
??:0:at::_ops::slice_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), &torch::autograd::VariableType::(anonymous namespace)::slice_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
??:0:at::_ops::slice_Tensor::call(at::Tensor const&, long, std::optional<c10::SymInt>, std::optional<c10::SymInt>, c10::SymInt)
:0:at::indexing::impl::applySlice(at::Tensor const&, long, c10::SymInt, c10::SymInt, c10::SymInt, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
:0:at::indexing::handleDimInMultiDimIndexing(at::Tensor const&, at::Tensor const&, at::indexing::TensorIndex const&, long*, long*, long, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<c10::ArrayRef<c10::SymInt> > const&)
python_variable_indexing.cpp:0:torch::autograd::applySlicing(at::Tensor const&, _object*, std::vector<at::Tensor, std::allocator<at::Tensor> >&, bool, c10::Device const&, std::optional<long> const&, long) [clone .constprop.0]
:0:torch::autograd::THPVariable_getitem(_object*, _object*)
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:165:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$216: bf16[6032, 3072] = torch._ops.aten.view.default($215, ['6032', '3072'])   (178 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:168:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$218: bf16[3072, 3072] = torch._ops.aten.t.default($217)   (179 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:168:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$220: bf16[6032, 3072] = torch._ops.aten.addmm.default($219, $216, $218)   (180 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:168:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$221: bf16[1, 6032, 3072] = torch._ops.aten.view.default($220, ['1', '6032', '3072'])   (181 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:168:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$222: bf16[116, 3072] = torch._ops.aten.view.default($212, ['116', '3072'])   (182 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:172:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$224: bf16[3072, 3072] = torch._ops.aten.t.default($223)   (183 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:172:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$226: bf16[116, 3072] = torch._ops.aten.addmm.default($225, $222, $224)   (184 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:172:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$227: bf16[1, 116, 3072] = torch._ops.aten.view.default($226, ['1', '116', '3072'])   (185 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:172:RegionalQwenAttnProcessor2_0_call
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/pipeline/pipeline_qwenimage_regional.py:213:__call__
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
??:0:PyObject_Call
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention_processor.py:605:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
??:0:PyObject_Call
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:436:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$228: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($29, $221)   (186 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:452:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$229: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($15, $228)   (187 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:452:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$230: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($44, $227)   (188 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:453:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$231: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($30, $230)   (189 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:453:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$232: bf16[1, 6032, 3072] = torch._ops.aten.detach.default($229)   (190 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:458:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$233: bf16[1, 6032, 3072] = torch._ops.aten.detach.default($232)   (191 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:458:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


('$234: bf16[1, 6032, 3072]', '$235: f32[1, 6032, 1]', '$236: f32[1, 6032, 1]') = torch._ops.aten.native_layer_norm.default($229, ['3072'], None, None, 1e-06)   (192 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:458:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


['$237: bf16[1, 3072]', '$238: bf16[1, 3072]', '$239: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($12, 3072, -1)   (193 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::ADInplaceOrView::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::autograd::VariableType::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::call(at::Tensor const&, c10::SymInt, long)
??:0:at::native::chunk(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__chunk>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, long)
??:0:at::_ops::chunk::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_chunk(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:392:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$240: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($238, 1)   (194 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$241: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($240, 1)   (195 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$242: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($234, $241)   (196 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$243: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($237, 1)   (197 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$244: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($242, $243)   (198 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$245: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($239, 1)   (199 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:459:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$246: bf16[6032, 3072] = torch._ops.aten.view.default($244, ['6032', '3072'])   (200 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$248: bf16[3072, 12288] = torch._ops.aten.t.default($247)   (201 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$250: bf16[6032, 12288] = torch._ops.aten.addmm.default($249, $246, $248)   (202 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$251: bf16[1, 6032, 12288] = torch._ops.aten.view.default($250, ['1', '6032', '12288'])   (203 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$252: bf16[1, 6032, 12288] = torch._ops.aten.detach.default($251)   (204 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::gelu(c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), &torch::autograd::VariableType::(anonymous namespace)::gelu>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> > > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
??:0:at::_ops::gelu::call(at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
python_nn_functions.cpp:0:torch::autograd::THPVariable_gelu(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:85:gelu
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:89:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$253: bf16[1, 6032, 12288] = torch._ops.aten.detach.default($252)   (205 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::gelu(c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), &torch::autograd::VariableType::(anonymous namespace)::gelu>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> > > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
??:0:at::_ops::gelu::call(at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
python_nn_functions.cpp:0:torch::autograd::THPVariable_gelu(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:85:gelu
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:89:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$254: bf16[1, 6032, 12288] = torch._ops.aten.gelu.default($251, approximate='tanh')   (206 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::gelu::redispatch(c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::gelu(c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), &torch::autograd::VariableType::(anonymous namespace)::gelu>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> > > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
??:0:at::_ops::gelu::call(at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
python_nn_functions.cpp:0:torch::autograd::THPVariable_gelu(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:85:gelu
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:89:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$255: bf16[6032, 12288] = torch._ops.aten.view.default($254, ['6032', '12288'])   (207 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$257: bf16[12288, 3072] = torch._ops.aten.t.default($256)   (208 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$259: bf16[6032, 3072] = torch._ops.aten.addmm.default($258, $255, $257)   (209 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$260: bf16[1, 6032, 3072] = torch._ops.aten.view.default($259, ['1', '6032', '3072'])   (210 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:460:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$261: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($245, $260)   (211 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:461:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$262: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($229, $261)   (212 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:461:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$263: bf16[1, 116, 3072] = torch._ops.aten.detach.default($231)   (213 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:464:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$264: bf16[1, 116, 3072] = torch._ops.aten.detach.default($263)   (214 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:464:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


('$265: bf16[1, 116, 3072]', '$266: f32[1, 116, 1]', '$267: f32[1, 116, 1]') = torch._ops.aten.native_layer_norm.default($231, ['3072'], None, None, 1e-06)   (215 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::native_layer_norm(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::tuple<at::Tensor, at::Tensor, at::Tensor> (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double), &torch::autograd::VariableType::(anonymous namespace)::native_layer_norm>, std::tuple<at::Tensor, at::Tensor, at::Tensor>, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::native_layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double)
??:0:at::native::layer_norm_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__layer_norm>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::layer_norm::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>, std::optional<at::Tensor> const&, std::optional<at::Tensor> const&, double, bool)
python_torch_functions_2.cpp:0:torch::autograd::THPVariable_layer_norm(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/functional.py:2905:layer_norm
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/normalization.py:217:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:464:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


['$268: bf16[1, 3072]', '$269: bf16[1, 3072]', '$270: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($14, 3072, -1)   (216 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::ADInplaceOrView::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::split_Tensor(c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long), &torch::autograd::VariableType::(anonymous namespace)::split_Tensor>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, c10::SymInt, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::SymInt, long)
??:0:at::_ops::split_Tensor::call(at::Tensor const&, c10::SymInt, long)
??:0:at::native::chunk(at::Tensor const&, long, long)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__chunk>, std::vector<at::Tensor, std::allocator<at::Tensor> >, c10::guts::typelist::typelist<at::Tensor const&, long, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<std::vector<at::Tensor, std::allocator<at::Tensor> > (at::Tensor const&, long, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long, long)
??:0:at::_ops::chunk::call(at::Tensor const&, long, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_chunk(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:392:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$271: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($269, 1)   (217 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$272: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($271, 1)   (218 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$273: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($265, $272)   (219 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$274: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($268, 1)   (220 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$275: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($273, $274)   (221 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$276: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($270, 1)   (222 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::ADInplaceOrView::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, long)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::redispatch(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:torch::autograd::VariableType::(anonymous namespace)::unsqueeze(c10::DispatchKeySet, at::Tensor const&, long)
VariableType_4.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, long), &torch::autograd::VariableType::(anonymous namespace)::unsqueeze>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, long> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, long), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, long)
??:0:at::_ops::unsqueeze::call(at::Tensor const&, long)
python_variable_methods.cpp:0:torch::autograd::THPVariable_unsqueeze(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:393:_modulate
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:465:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$277: bf16[116, 3072] = torch._ops.aten.view.default($275, ['116', '3072'])   (223 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$279: bf16[3072, 12288] = torch._ops.aten.t.default($278)   (224 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$281: bf16[116, 12288] = torch._ops.aten.addmm.default($280, $277, $279)   (225 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$282: bf16[1, 116, 12288] = torch._ops.aten.view.default($281, ['1', '116', '12288'])   (226 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:88:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$283: bf16[1, 116, 12288] = torch._ops.aten.detach.default($282)   (227 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::gelu(c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), &torch::autograd::VariableType::(anonymous namespace)::gelu>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> > > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
??:0:at::_ops::gelu::call(at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
python_nn_functions.cpp:0:torch::autograd::THPVariable_gelu(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:85:gelu
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:89:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$284: bf16[1, 116, 12288] = torch._ops.aten.detach.default($283)   (228 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::torchDispatchFromTensorImpl(c10::TensorImpl const*, char const*, _object*, char const*, c10::SmallVector<pybind11::object, 1u>)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::detach(c10::TensorImpl const*) const
??:0:c10::intrusive_ptr<c10::TensorImpl, c10::detail::intrusive_target_default_null_type<c10::TensorImpl> > c10::TensorImpl::shallow_copy_and_detach_core<c10::VariableVersion const&>(c10::VariableVersion const&, bool) const
??:0:c10::TensorImpl::shallow_copy_and_detach(c10::VariableVersion const&, bool) const
:0:torch::autograd::make_variable_non_differentiable_view(at::Tensor const&, at::Tensor const&, bool)
:0:torch::autograd::as_view(at::Tensor const&, at::Tensor const&, bool, bool, std::unique_ptr<torch::autograd::ViewFunc, std::default_delete<torch::autograd::ViewFunc> >, std::function<at::Tensor (at::Tensor const&)>, torch::autograd::CreationMeta, bool)
VariableTypeManual.cpp:0:torch::ADInplaceOrView::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:torch::autograd::VariableType::(anonymous namespace)::detach(c10::DispatchKeySet, at::Tensor const&)
VariableTypeManual.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::detach>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::detach::call(at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_detach(_object*, _object*)
:0:method_vectorcall_NOARGS
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1063:pack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_pack_hook(at::Tensor const&)
??:0:torch::autograd::SavedVariable::set_hooks_and_pack_data(std::unique_ptr<torch::autograd::SavedVariableHooks, std::default_delete<torch::autograd::SavedVariableHooks> >&&, at::Tensor const&)
??:0:torch::autograd::SavedVariable::SavedVariable(at::Tensor const&, bool, bool)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::gelu(c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), &torch::autograd::VariableType::(anonymous namespace)::gelu>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> > > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
??:0:at::_ops::gelu::call(at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
python_nn_functions.cpp:0:torch::autograd::THPVariable_gelu(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:85:gelu
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:89:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$285: bf16[1, 116, 12288] = torch._ops.aten.gelu.default($282, approximate='tanh')   (229 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::gelu::redispatch(c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
VariableType_1.cpp:0:torch::autograd::VariableType::(anonymous namespace)::gelu(c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
VariableType_1.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), &torch::autograd::VariableType::(anonymous namespace)::gelu>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> > > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
??:0:at::_ops::gelu::call(at::Tensor const&, std::basic_string_view<char, std::char_traits<char> >)
python_nn_functions.cpp:0:torch::autograd::THPVariable_gelu(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:85:gelu
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/activations.py:89:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$286: bf16[116, 12288] = torch._ops.aten.view.default($285, ['116', '12288'])   (230 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::native::reshape_symint(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__reshape>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::reshape::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$288: bf16[12288, 3072] = torch._ops.aten.t.default($287)   (231 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
ADInplaceOrViewType_0.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::ADInplaceOrView::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, at::Tensor (c10::DispatchKeySet, at::Tensor const&)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::redispatch(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::t(c10::DispatchKeySet, at::Tensor const&)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::t>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&)
??:0:at::_ops::t::call(at::Tensor const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$290: bf16[116, 3072] = torch._ops.aten.addmm.default($289, $286, $288)   (232 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::addmm::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::addmm(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::addmm>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
??:0:at::_ops::addmm::call(at::Tensor const&, at::Tensor const&, at::Tensor const&, c10::Scalar const&, c10::Scalar const&)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$291: bf16[1, 116, 3072] = torch._ops.aten.view.default($290, ['1', '116', '3072'])   (233 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:torch::ADInplaceOrView::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
ADInplaceOrViewType_1.cpp:0:c10::impl::wrap_kernel_functor_unboxed_<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::ADInplaceOrView::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)>::call(c10::OperatorKernel*, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::redispatch(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:torch::autograd::VariableType::(anonymous namespace)::view(c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
VariableType_3.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>), &torch::autograd::VariableType::(anonymous namespace)::view>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt> > >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, c10::ArrayRef<c10::SymInt>), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, c10::ArrayRef<c10::SymInt>)
??:0:at::_ops::view::call(at::Tensor const&, c10::ArrayRef<c10::SymInt>)
Linear.cpp:0:at::native::_flatten_nd_linear(at::Tensor const&, at::Tensor const&, at::Tensor const&)
??:0:at::native::linear(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
RegisterCompositeImplicitAutograd_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&), &at::(anonymous namespace)::(anonymous namespace)::wrapper_CompositeImplicitAutograd__linear>, at::Tensor, c10::guts::typelist::typelist<at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::linear::call(at::Tensor const&, at::Tensor const&, std::optional<at::Tensor> const&)
python_nn_functions.cpp:0:torch::autograd::THPVariable_linear(_object*, _object*, _object*)
:0:cfunction_call
:0:_PyObject_MakeTpCall.localalias
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/linear.py:125:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/attention.py:1731:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:_PyObject_FastCallDictTstate.localalias
??:0:_PyObject_Call_Prepend
:0:slot_tp_call
:0:_PyObject_MakeTpCall.localalias
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:466:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$292: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($276, $291)   (234 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:torch::autograd::VariableType::(anonymous namespace)::mul_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
VariableType_0.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&), &torch::autograd::VariableType::(anonymous namespace)::mul_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
:0:c10::impl::BoxedKernelWrapper<at::Tensor (at::Tensor const&, at::Tensor const&), void>::call(c10::BoxedKernel const&, c10::OperatorHandle const&, c10::DispatchKeySet, at::Tensor const&, at::Tensor const&)
??:0:at::_ops::mul_Tensor::call(at::Tensor const&, at::Tensor const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_mul(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_mul>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_multiply
??:0:PyNumber_Multiply
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:467:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone


$293: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($231, $292)   (235 of 235 in recompute)

??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
:0:_PyObject_CallFunctionVa
??:0:PyObject_CallMethod
??:0:torch::handle_torch_function_no_python_arg_parser(c10::ArrayRef<_object*>, _object*, _object*, char const*, _object*, char const*, torch::TorchFunctionName)
PyInterpreter.cpp:0:torch::detail::(anonymous namespace)::ConcretePyInterpreterVTable::dispatch(c10::OperatorHandle const&, std::vector<c10::IValue, std::allocator<c10::IValue> >*) const
PythonFallbackKernel.cpp:0:(anonymous namespace)::pythonFallback(c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::redispatch(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:torch::autograd::VariableType::(anonymous namespace)::add_Tensor(c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&)
VariableType_2.cpp:0:c10::impl::make_boxed_from_unboxed_functor<c10::impl::detail::WrapFunctionIntoFunctor_<c10::CompileTimeFunctionPointer<at::Tensor (c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&), &torch::autograd::VariableType::(anonymous namespace)::add_Tensor>, at::Tensor, c10::guts::typelist::typelist<c10::DispatchKeySet, at::Tensor const&, at::Tensor const&, c10::Scalar const&> >, false>::call(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
PythonFallbackKernel.cpp:0:void c10::BoxedKernel::make_boxed_function<&(anonymous namespace)::pythonTLSSnapshotFallback>(c10::OperatorKernel*, c10::OperatorHandle const&, c10::DispatchKeySet, std::vector<c10::IValue, std::allocator<c10::IValue> >*)
??:0:at::_ops::add_Tensor::call(at::Tensor const&, at::Tensor const&, c10::Scalar const&)
python_variable_methods.cpp:0:torch::autograd::THPVariable_add(_object*, _object*, _object*)
python_variable_methods.cpp:0:_object* torch::autograd::TypeError_to_NotImplemented_<&torch::autograd::THPVariable_add>(_object*, _object*, _object*)
:0:method_vectorcall_VARARGS_KEYWORDS.cold
:0:vectorcall_maybe.constprop.0
:0:slot_nb_add
??:0:PyNumber_Add
/data02/sxm/flux-workspace/Qwen-Image/diffusers/src/diffusers/models/transformers/transformer_qwenimage.py:467:forward
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1784:_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/nn/modules/module.py:1773:_wrapped_call_impl
??:0:_PyEval_EvalFrameDefault
:0:method_vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1542:recompute_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1116:_run_fn_with_dynamo_disabled
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_dynamo/eval_frame.py:929:_fn
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/_compile.py:53:inner
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1146:unpack_hook
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
/home/sxm/anaconda3/envs/qwenImageEnv/lib/python3.10/site-packages/torch/utils/checkpoint.py:1168:unpack_hook_with_error_cb
??:0:_PyEval_EvalFrameDefault
??:0:_PyFunction_Vectorcall
:0:object_vacall
??:0:PyObject_CallFunctionObjArgs
:0:torch::autograd::PySavedVariableHooks::call_unpack_hook()
??:0:torch::autograd::SavedVariable::unpack(std::shared_ptr<torch::autograd::Node>) const
??:0:torch::autograd::generated::SoftmaxBackward0::apply(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
:0:torch::autograd::Node::operator()(std::vector<at::Tensor, std::allocator<at::Tensor> >&&)
??:0:torch::autograd::Engine::evaluate_function(std::shared_ptr<torch::autograd::GraphTask>&, torch::autograd::Node*, torch::autograd::InputBuffer&, std::shared_ptr<torch::autograd::ReadyQueue> const&)
??:0:torch::autograd::Engine::thread_main(std::shared_ptr<torch::autograd::GraphTask> const&)
??:0:torch::autograd::Engine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
:0:torch::autograd::python::PythonEngine::thread_init(int, std::shared_ptr<torch::autograd::ReadyQueue> const&, bool)
??:0:std::error_code::default_error_condition() const
/build/glibc-B3wQXB/glibc-2.31/nptl/pthread_create.c:477:start_thread
??:0:clone



+~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~+
|       3. Log of operators in the original forward and recomputation          |
+------------------------------------------------------------------------------+
(Scroll up to correlate stack traces with each operation listed below. This
 helps identify their source in the code.)

IMPORTANT: Differences in "detach" calls between the original forward and the
           recomputation are expected. They are introduced by the checkpointing
           mechanism and can be ignored.

Operations executed during the original forward:

$1: bf16[1, 3072] = torch._ops.aten.silu.default($0)
$3: bf16[3072, 18432] = torch._ops.aten.t.default($2)
$5: bf16[1, 18432] = torch._ops.aten.addmm.default($4, $1, $3)
$6: bf16[1, 3072] = torch._ops.aten.silu.default($0)
$8: bf16[3072, 18432] = torch._ops.aten.t.default($7)
$10: bf16[1, 18432] = torch._ops.aten.addmm.default($9, $6, $8)
['$11: bf16[1, 9216]', '$12: bf16[1, 9216]'] = torch._ops.aten.split.Tensor($5, 9216, -1)
['$13: bf16[1, 9216]', '$14: bf16[1, 9216]'] = torch._ops.aten.split.Tensor($10, 9216, -1)
('$16: bf16[1, 6032, 3072]', '$17: f32[1, 6032, 1]', '$18: f32[1, 6032, 1]') = torch._ops.aten.native_layer_norm.default($15, ['3072'], None, None, 1e-06)
['$19: bf16[1, 3072]', '$20: bf16[1, 3072]', '$21: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($11, 3072, -1)
$22: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($20, 1)
$23: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($22, 1)
$24: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($16, $23)
$25: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($19, 1)
$26: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($24, $25)
$27: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($21, 1)
('$29: bf16[1, 116, 3072]', '$30: f32[1, 116, 1]', '$31: f32[1, 116, 1]') = torch._ops.aten.native_layer_norm.default($28, ['3072'], None, None, 1e-06)
['$32: bf16[1, 3072]', '$33: bf16[1, 3072]', '$34: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($13, 3072, -1)
$35: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($33, 1)
$36: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($35, 1)
$37: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($29, $36)
$38: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($32, 1)
$39: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($37, $38)
$40: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($34, 1)
$41: bf16[6032, 3072] = torch._ops.aten.view.default($26, ['6032', '3072'])
$43: bf16[3072, 3072] = torch._ops.aten.t.default($42)
$45: bf16[6032, 3072] = torch._ops.aten.addmm.default($44, $41, $43)
$46: bf16[1, 6032, 3072] = torch._ops.aten.view.default($45, ['1', '6032', '3072'])
$47: bf16[6032, 3072] = torch._ops.aten.view.default($26, ['6032', '3072'])
$49: bf16[3072, 3072] = torch._ops.aten.t.default($48)
$51: bf16[6032, 3072] = torch._ops.aten.addmm.default($50, $47, $49)
$52: bf16[1, 6032, 3072] = torch._ops.aten.view.default($51, ['1', '6032', '3072'])
$53: bf16[6032, 3072] = torch._ops.aten.view.default($26, ['6032', '3072'])
$55: bf16[3072, 3072] = torch._ops.aten.t.default($54)
$57: bf16[6032, 3072] = torch._ops.aten.addmm.default($56, $53, $55)
$58: bf16[1, 6032, 3072] = torch._ops.aten.view.default($57, ['1', '6032', '3072'])
$59: bf16[116, 3072] = torch._ops.aten.view.default($39, ['116', '3072'])
$61: bf16[3072, 3072] = torch._ops.aten.t.default($60)
$63: bf16[116, 3072] = torch._ops.aten.addmm.default($62, $59, $61)
$64: bf16[1, 116, 3072] = torch._ops.aten.view.default($63, ['1', '116', '3072'])
$65: bf16[116, 3072] = torch._ops.aten.view.default($39, ['116', '3072'])
$67: bf16[3072, 3072] = torch._ops.aten.t.default($66)
$69: bf16[116, 3072] = torch._ops.aten.addmm.default($68, $65, $67)
$70: bf16[1, 116, 3072] = torch._ops.aten.view.default($69, ['1', '116', '3072'])
$71: bf16[116, 3072] = torch._ops.aten.view.default($39, ['116', '3072'])
$73: bf16[3072, 3072] = torch._ops.aten.t.default($72)
$75: bf16[116, 3072] = torch._ops.aten.addmm.default($74, $71, $73)
$76: bf16[1, 116, 3072] = torch._ops.aten.view.default($75, ['1', '116', '3072'])
$77: bf16[1, 6032, 24, 128] = torch._ops.aten.view.default($46, ['1', '6032', '24', '128'])
$78: bf16[1, 6032, 24, 128] = torch._ops.aten.view.default($52, ['1', '6032', '24', '128'])
$79: bf16[1, 6032, 24, 128] = torch._ops.aten.view.default($58, ['1', '6032', '24', '128'])
$80: bf16[1, 116, 24, 128] = torch._ops.aten.view.default($64, ['1', '116', '24', '128'])
$81: bf16[1, 116, 24, 128] = torch._ops.aten.view.default($70, ['1', '116', '24', '128'])
$82: bf16[1, 116, 24, 128] = torch._ops.aten.view.default($76, ['1', '116', '24', '128'])
$83: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($77, dtype=torch.float32)
$84: f32[1, 6032, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($83, 2)
$85: f32[1, 6032, 24, 1] = torch._ops.aten.mean.dim($84, ['-1'], True)
$86: f32[1, 6032, 24, 1] = torch._ops.aten.add.Tensor($85, 1e-06)
$87: f32[1, 6032, 24, 1] = torch._ops.aten.rsqrt.default($86)
$88: f32[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($77, $87)
$89: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($88, dtype=torch.bfloat16)
$91: bf16[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($89, $90)
$92: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($78, dtype=torch.float32)
$93: f32[1, 6032, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($92, 2)
$94: f32[1, 6032, 24, 1] = torch._ops.aten.mean.dim($93, ['-1'], True)
$95: f32[1, 6032, 24, 1] = torch._ops.aten.add.Tensor($94, 1e-06)
$96: f32[1, 6032, 24, 1] = torch._ops.aten.rsqrt.default($95)
$97: f32[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($78, $96)
$98: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($97, dtype=torch.bfloat16)
$100: bf16[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($98, $99)
$101: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($80, dtype=torch.float32)
$102: f32[1, 116, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($101, 2)
$103: f32[1, 116, 24, 1] = torch._ops.aten.mean.dim($102, ['-1'], True)
$104: f32[1, 116, 24, 1] = torch._ops.aten.add.Tensor($103, 1e-06)
$105: f32[1, 116, 24, 1] = torch._ops.aten.rsqrt.default($104)
$106: f32[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($80, $105)
$107: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($106, dtype=torch.bfloat16)
$109: bf16[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($107, $108)
$110: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($81, dtype=torch.float32)
$111: f32[1, 116, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($110, 2)
$112: f32[1, 116, 24, 1] = torch._ops.aten.mean.dim($111, ['-1'], True)
$113: f32[1, 116, 24, 1] = torch._ops.aten.add.Tensor($112, 1e-06)
$114: f32[1, 116, 24, 1] = torch._ops.aten.rsqrt.default($113)
$115: f32[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($81, $114)
$116: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($115, dtype=torch.bfloat16)
$118: bf16[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($116, $117)
$119: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($91, dtype=torch.float32)
$120: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view.default($119, ['1', '6032', '24', '-1', '2'])
$121: c64[1, 6032, 24, 64] = torch._ops.aten.view_as_complex.default($120)
$123: c64[6032, 1, 64] = torch._ops.aten.unsqueeze.default($122, 1)
$124: c64[1, 6032, 24, 64] = torch._ops.aten.mul.Tensor($121, $123)
$125: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view_as_real.default($124)
$126: f32[1, 6032, 24, 128] = torch._ops.aten.view.default($125, ['1', '6032', '24', '128'])
$127: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($126, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))
$128: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($100, dtype=torch.float32)
$129: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view.default($128, ['1', '6032', '24', '-1', '2'])
$130: c64[1, 6032, 24, 64] = torch._ops.aten.view_as_complex.default($129)
$131: c64[6032, 1, 64] = torch._ops.aten.unsqueeze.default($122, 1)
$132: c64[1, 6032, 24, 64] = torch._ops.aten.mul.Tensor($130, $131)
$133: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view_as_real.default($132)
$134: f32[1, 6032, 24, 128] = torch._ops.aten.view.default($133, ['1', '6032', '24', '128'])
$135: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($134, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))
$136: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($109, dtype=torch.float32)
$137: f32[1, 116, 24, 64, 2] = torch._ops.aten.view.default($136, ['1', '116', '24', '-1', '2'])
$138: c64[1, 116, 24, 64] = torch._ops.aten.view_as_complex.default($137)
$140: c64[116, 1, 64] = torch._ops.aten.unsqueeze.default($139, 1)
$141: c64[1, 116, 24, 64] = torch._ops.aten.mul.Tensor($138, $140)
$142: f32[1, 116, 24, 64, 2] = torch._ops.aten.view_as_real.default($141)
$143: f32[1, 116, 24, 128] = torch._ops.aten.view.default($142, ['1', '116', '24', '128'])
$144: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($143, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))
$145: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($118, dtype=torch.float32)
$146: f32[1, 116, 24, 64, 2] = torch._ops.aten.view.default($145, ['1', '116', '24', '-1', '2'])
$147: c64[1, 116, 24, 64] = torch._ops.aten.view_as_complex.default($146)
$148: c64[116, 1, 64] = torch._ops.aten.unsqueeze.default($139, 1)
$149: c64[1, 116, 24, 64] = torch._ops.aten.mul.Tensor($147, $148)
$150: f32[1, 116, 24, 64, 2] = torch._ops.aten.view_as_real.default($149)
$151: f32[1, 116, 24, 128] = torch._ops.aten.view.default($150, ['1', '116', '24', '128'])
$152: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($151, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))
$153: bf16[1, 6148, 24, 128] = torch._ops.aten.cat.default(['$144', '$127'], 1)
$154: bf16[1, 6148, 24, 128] = torch._ops.aten.cat.default(['$152', '$135'], 1)
$155: bf16[1, 6148, 24, 128] = torch._ops.aten.cat.default(['$82', '$79'], 1)
$156: bf16[1, 24, 6148, 128] = torch._ops.aten.permute.default($153, ['0', '2', '1', '3'])
$157: bf16[1, 24, 6148, 128] = torch._ops.aten.permute.default($154, ['0', '2', '1', '3'])
$158: bf16[1, 24, 6148, 128] = torch._ops.aten.permute.default($155, ['0', '2', '1', '3'])
('$159: bf16[1, 24, 6148, 128]', '$160: f32[1, 24, 6148]', 'None', 'None', '6148', '6148', '$161: u64[2]', '$162: u64[]', '$163: bf16[0]') = torch._ops.aten._scaled_dot_product_flash_attention.default($156, $157, $158, scale=0.08838834764831843)
$164: bf16[1, 6148, 24, 128] = torch._ops.aten.permute.default($159, ['0', '2', '1', '3'])
$165: bf16[1, 6032, 116] = torch._ops.aten.empty.memory_format(['1', '6032', '116'], dtype=torch.bfloat16, device=device(type='cuda', index=0), pin_memory=False)
$166: bf16[1, 3072, 116] = torch._ops.aten.transpose.int($39, -1, -2)
$167: bf16[1, 6032, 116] = torch._ops.aten.baddbmm.default($165, $26, $166, beta=0, alpha=0.08838834764831845)
$168: bf16[1, 6032, 116] = torch._ops.aten._softmax.default($167, -1, False)
$169: bf16[1, 6148, 3072] = torch._ops.aten.view.default($164, ['1', '6148', '3072'])
$170: bf16[1, 6148, 3072] = torch._ops.aten.slice.Tensor($169, 0, 0, 9223372036854775807)
$171: bf16[1, 116, 3072] = torch._ops.aten.slice.Tensor($170, 1, 0, 116)
$172: bf16[1, 116, 3072] = torch._ops.aten.slice.Tensor($171, 2, 0, 9223372036854775807)
$173: bf16[1, 6148, 3072] = torch._ops.aten.slice.Tensor($169, 0, 0, 9223372036854775807)
$174: bf16[1, 6032, 3072] = torch._ops.aten.slice.Tensor($173, 1, 116, 9223372036854775807)
$175: bf16[1, 6032, 3072] = torch._ops.aten.slice.Tensor($174, 2, 0, 9223372036854775807)
$176: bf16[6032, 3072] = torch._ops.aten.view.default($175, ['6032', '3072'])
$178: bf16[3072, 3072] = torch._ops.aten.t.default($177)
$180: bf16[6032, 3072] = torch._ops.aten.addmm.default($179, $176, $178)
$181: bf16[1, 6032, 3072] = torch._ops.aten.view.default($180, ['1', '6032', '3072'])
$182: bf16[116, 3072] = torch._ops.aten.view.default($172, ['116', '3072'])
$184: bf16[3072, 3072] = torch._ops.aten.t.default($183)
$186: bf16[116, 3072] = torch._ops.aten.addmm.default($185, $182, $184)
$187: bf16[1, 116, 3072] = torch._ops.aten.view.default($186, ['1', '116', '3072'])
$188: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($27, $181)
$189: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($15, $188)
$190: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($40, $187)
$191: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($28, $190)
('$192: bf16[1, 6032, 3072]', '$193: f32[1, 6032, 1]', '$194: f32[1, 6032, 1]') = torch._ops.aten.native_layer_norm.default($189, ['3072'], None, None, 1e-06)
['$195: bf16[1, 3072]', '$196: bf16[1, 3072]', '$197: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($12, 3072, -1)
$198: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($196, 1)
$199: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($198, 1)
$200: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($192, $199)
$201: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($195, 1)
$202: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($200, $201)
$203: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($197, 1)
$204: bf16[6032, 3072] = torch._ops.aten.view.default($202, ['6032', '3072'])
$206: bf16[3072, 12288] = torch._ops.aten.t.default($205)
$208: bf16[6032, 12288] = torch._ops.aten.addmm.default($207, $204, $206)
$209: bf16[1, 6032, 12288] = torch._ops.aten.view.default($208, ['1', '6032', '12288'])
$210: bf16[1, 6032, 12288] = torch._ops.aten.gelu.default($209, approximate='tanh')
$211: bf16[6032, 12288] = torch._ops.aten.view.default($210, ['6032', '12288'])
$213: bf16[12288, 3072] = torch._ops.aten.t.default($212)
$215: bf16[6032, 3072] = torch._ops.aten.addmm.default($214, $211, $213)
$216: bf16[1, 6032, 3072] = torch._ops.aten.view.default($215, ['1', '6032', '3072'])
$217: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($203, $216)
$218: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($189, $217)
('$219: bf16[1, 116, 3072]', '$220: f32[1, 116, 1]', '$221: f32[1, 116, 1]') = torch._ops.aten.native_layer_norm.default($191, ['3072'], None, None, 1e-06)
['$222: bf16[1, 3072]', '$223: bf16[1, 3072]', '$224: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($14, 3072, -1)
$225: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($223, 1)
$226: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($225, 1)
$227: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($219, $226)
$228: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($222, 1)
$229: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($227, $228)
$230: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($224, 1)
$231: bf16[116, 3072] = torch._ops.aten.view.default($229, ['116', '3072'])
$233: bf16[3072, 12288] = torch._ops.aten.t.default($232)
$235: bf16[116, 12288] = torch._ops.aten.addmm.default($234, $231, $233)
$236: bf16[1, 116, 12288] = torch._ops.aten.view.default($235, ['1', '116', '12288'])
$237: bf16[1, 116, 12288] = torch._ops.aten.gelu.default($236, approximate='tanh')
$238: bf16[116, 12288] = torch._ops.aten.view.default($237, ['116', '12288'])
$240: bf16[12288, 3072] = torch._ops.aten.t.default($239)
$242: bf16[116, 3072] = torch._ops.aten.addmm.default($241, $238, $240)
$243: bf16[1, 116, 3072] = torch._ops.aten.view.default($242, ['1', '116', '3072'])
$244: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($230, $243)
$245: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($191, $244)

Operations executed during recomputation:

$1: bf16[1, 3072] = torch._ops.aten.silu.default($0)
$3: bf16[3072, 18432] = torch._ops.aten.t.default($2)
$5: bf16[1, 18432] = torch._ops.aten.addmm.default($4, $1, $3)
$6: bf16[1, 3072] = torch._ops.aten.silu.default($0)
$8: bf16[3072, 18432] = torch._ops.aten.t.default($7)
$10: bf16[1, 18432] = torch._ops.aten.addmm.default($9, $6, $8)
['$11: bf16[1, 9216]', '$12: bf16[1, 9216]'] = torch._ops.aten.split.Tensor($5, 9216, -1)
['$13: bf16[1, 9216]', '$14: bf16[1, 9216]'] = torch._ops.aten.split.Tensor($10, 9216, -1)
$16: bf16[1, 6032, 3072] = torch._ops.aten.detach.default($15)
$17: bf16[1, 6032, 3072] = torch._ops.aten.detach.default($16)
('$18: bf16[1, 6032, 3072]', '$19: f32[1, 6032, 1]', '$20: f32[1, 6032, 1]') = torch._ops.aten.native_layer_norm.default($15, ['3072'], None, None, 1e-06)
['$21: bf16[1, 3072]', '$22: bf16[1, 3072]', '$23: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($11, 3072, -1)
$24: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($22, 1)
$25: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($24, 1)
$26: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($18, $25)
$27: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($21, 1)
$28: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($26, $27)
$29: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($23, 1)
$31: bf16[1, 116, 3072] = torch._ops.aten.detach.default($30)
$32: bf16[1, 116, 3072] = torch._ops.aten.detach.default($31)
('$33: bf16[1, 116, 3072]', '$34: f32[1, 116, 1]', '$35: f32[1, 116, 1]') = torch._ops.aten.native_layer_norm.default($30, ['3072'], None, None, 1e-06)
['$36: bf16[1, 3072]', '$37: bf16[1, 3072]', '$38: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($13, 3072, -1)
$39: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($37, 1)
$40: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($39, 1)
$41: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($33, $40)
$42: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($36, 1)
$43: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($41, $42)
$44: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($38, 1)
$45: bf16[6032, 3072] = torch._ops.aten.view.default($28, ['6032', '3072'])
$47: bf16[3072, 3072] = torch._ops.aten.t.default($46)
$49: bf16[6032, 3072] = torch._ops.aten.addmm.default($48, $45, $47)
$50: bf16[1, 6032, 3072] = torch._ops.aten.view.default($49, ['1', '6032', '3072'])
$51: bf16[6032, 3072] = torch._ops.aten.view.default($28, ['6032', '3072'])
$53: bf16[3072, 3072] = torch._ops.aten.t.default($52)
$55: bf16[6032, 3072] = torch._ops.aten.addmm.default($54, $51, $53)
$56: bf16[1, 6032, 3072] = torch._ops.aten.view.default($55, ['1', '6032', '3072'])
$57: bf16[6032, 3072] = torch._ops.aten.view.default($28, ['6032', '3072'])
$59: bf16[3072, 3072] = torch._ops.aten.t.default($58)
$61: bf16[6032, 3072] = torch._ops.aten.addmm.default($60, $57, $59)
$62: bf16[1, 6032, 3072] = torch._ops.aten.view.default($61, ['1', '6032', '3072'])
$63: bf16[116, 3072] = torch._ops.aten.view.default($43, ['116', '3072'])
$65: bf16[3072, 3072] = torch._ops.aten.t.default($64)
$67: bf16[116, 3072] = torch._ops.aten.addmm.default($66, $63, $65)
$68: bf16[1, 116, 3072] = torch._ops.aten.view.default($67, ['1', '116', '3072'])
$69: bf16[116, 3072] = torch._ops.aten.view.default($43, ['116', '3072'])
$71: bf16[3072, 3072] = torch._ops.aten.t.default($70)
$73: bf16[116, 3072] = torch._ops.aten.addmm.default($72, $69, $71)
$74: bf16[1, 116, 3072] = torch._ops.aten.view.default($73, ['1', '116', '3072'])
$75: bf16[116, 3072] = torch._ops.aten.view.default($43, ['116', '3072'])
$77: bf16[3072, 3072] = torch._ops.aten.t.default($76)
$79: bf16[116, 3072] = torch._ops.aten.addmm.default($78, $75, $77)
$80: bf16[1, 116, 3072] = torch._ops.aten.view.default($79, ['1', '116', '3072'])
$81: bf16[1, 6032, 24, 128] = torch._ops.aten.view.default($50, ['1', '6032', '24', '128'])
$82: bf16[1, 6032, 24, 128] = torch._ops.aten.view.default($56, ['1', '6032', '24', '128'])
$83: bf16[1, 6032, 24, 128] = torch._ops.aten.view.default($62, ['1', '6032', '24', '128'])
$84: bf16[1, 116, 24, 128] = torch._ops.aten.view.default($68, ['1', '116', '24', '128'])
$85: bf16[1, 116, 24, 128] = torch._ops.aten.view.default($74, ['1', '116', '24', '128'])
$86: bf16[1, 116, 24, 128] = torch._ops.aten.view.default($80, ['1', '116', '24', '128'])
$87: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($81, dtype=torch.float32)
$88: f32[1, 6032, 24, 128] = torch._ops.aten.detach.default($87)
$89: f32[1, 6032, 24, 128] = torch._ops.aten.detach.default($88)
$90: f32[1, 6032, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($87, 2)
$91: f32[1, 6032, 24, 1] = torch._ops.aten.mean.dim($90, ['-1'], True)
$92: f32[1, 6032, 24, 1] = torch._ops.aten.add.Tensor($91, 1e-06)
$93: f32[1, 6032, 24, 1] = torch._ops.aten.rsqrt.default($92)
$94: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($93)
$95: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($94)
$96: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($93)
$97: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($96)
$98: bf16[1, 6032, 24, 128] = torch._ops.aten.detach.default($81)
$99: bf16[1, 6032, 24, 128] = torch._ops.aten.detach.default($98)
$100: f32[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($81, $93)
$101: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($100, dtype=torch.bfloat16)
$103: bf16[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($101, $102)
$104: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($82, dtype=torch.float32)
$105: f32[1, 6032, 24, 128] = torch._ops.aten.detach.default($104)
$106: f32[1, 6032, 24, 128] = torch._ops.aten.detach.default($105)
$107: f32[1, 6032, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($104, 2)
$108: f32[1, 6032, 24, 1] = torch._ops.aten.mean.dim($107, ['-1'], True)
$109: f32[1, 6032, 24, 1] = torch._ops.aten.add.Tensor($108, 1e-06)
$110: f32[1, 6032, 24, 1] = torch._ops.aten.rsqrt.default($109)
$111: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($110)
$112: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($111)
$113: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($110)
$114: f32[1, 6032, 24, 1] = torch._ops.aten.detach.default($113)
$115: bf16[1, 6032, 24, 128] = torch._ops.aten.detach.default($82)
$116: bf16[1, 6032, 24, 128] = torch._ops.aten.detach.default($115)
$117: f32[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($82, $110)
$118: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($117, dtype=torch.bfloat16)
$120: bf16[1, 6032, 24, 128] = torch._ops.aten.mul.Tensor($118, $119)
$121: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($84, dtype=torch.float32)
$122: f32[1, 116, 24, 128] = torch._ops.aten.detach.default($121)
$123: f32[1, 116, 24, 128] = torch._ops.aten.detach.default($122)
$124: f32[1, 116, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($121, 2)
$125: f32[1, 116, 24, 1] = torch._ops.aten.mean.dim($124, ['-1'], True)
$126: f32[1, 116, 24, 1] = torch._ops.aten.add.Tensor($125, 1e-06)
$127: f32[1, 116, 24, 1] = torch._ops.aten.rsqrt.default($126)
$128: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($127)
$129: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($128)
$130: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($127)
$131: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($130)
$132: bf16[1, 116, 24, 128] = torch._ops.aten.detach.default($84)
$133: bf16[1, 116, 24, 128] = torch._ops.aten.detach.default($132)
$134: f32[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($84, $127)
$135: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($134, dtype=torch.bfloat16)
$137: bf16[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($135, $136)
$138: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($85, dtype=torch.float32)
$139: f32[1, 116, 24, 128] = torch._ops.aten.detach.default($138)
$140: f32[1, 116, 24, 128] = torch._ops.aten.detach.default($139)
$141: f32[1, 116, 24, 128] = torch._ops.aten.pow.Tensor_Scalar($138, 2)
$142: f32[1, 116, 24, 1] = torch._ops.aten.mean.dim($141, ['-1'], True)
$143: f32[1, 116, 24, 1] = torch._ops.aten.add.Tensor($142, 1e-06)
$144: f32[1, 116, 24, 1] = torch._ops.aten.rsqrt.default($143)
$145: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($144)
$146: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($145)
$147: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($144)
$148: f32[1, 116, 24, 1] = torch._ops.aten.detach.default($147)
$149: bf16[1, 116, 24, 128] = torch._ops.aten.detach.default($85)
$150: bf16[1, 116, 24, 128] = torch._ops.aten.detach.default($149)
$151: f32[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($85, $144)
$152: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($151, dtype=torch.bfloat16)
$154: bf16[1, 116, 24, 128] = torch._ops.aten.mul.Tensor($152, $153)
$155: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($103, dtype=torch.float32)
$156: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view.default($155, ['1', '6032', '24', '-1', '2'])
$157: c64[1, 6032, 24, 64] = torch._ops.aten.view_as_complex.default($156)
$159: c64[6032, 1, 64] = torch._ops.aten.unsqueeze.default($158, 1)
$160: c64[1, 6032, 24, 64] = torch._ops.aten.mul.Tensor($157, $159)
$161: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view_as_real.default($160)
$162: f32[1, 6032, 24, 128] = torch._ops.aten.view.default($161, ['1', '6032', '24', '128'])
$163: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($162, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))
$164: f32[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($120, dtype=torch.float32)
$165: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view.default($164, ['1', '6032', '24', '-1', '2'])
$166: c64[1, 6032, 24, 64] = torch._ops.aten.view_as_complex.default($165)
$167: c64[6032, 1, 64] = torch._ops.aten.unsqueeze.default($158, 1)
$168: c64[1, 6032, 24, 64] = torch._ops.aten.mul.Tensor($166, $167)
$169: f32[1, 6032, 24, 64, 2] = torch._ops.aten.view_as_real.default($168)
$170: f32[1, 6032, 24, 128] = torch._ops.aten.view.default($169, ['1', '6032', '24', '128'])
$171: bf16[1, 6032, 24, 128] = torch._ops.aten._to_copy.default($170, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))
$172: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($137, dtype=torch.float32)
$173: f32[1, 116, 24, 64, 2] = torch._ops.aten.view.default($172, ['1', '116', '24', '-1', '2'])
$174: c64[1, 116, 24, 64] = torch._ops.aten.view_as_complex.default($173)
$176: c64[116, 1, 64] = torch._ops.aten.unsqueeze.default($175, 1)
$177: c64[1, 116, 24, 64] = torch._ops.aten.mul.Tensor($174, $176)
$178: f32[1, 116, 24, 64, 2] = torch._ops.aten.view_as_real.default($177)
$179: f32[1, 116, 24, 128] = torch._ops.aten.view.default($178, ['1', '116', '24', '128'])
$180: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($179, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))
$181: f32[1, 116, 24, 128] = torch._ops.aten._to_copy.default($154, dtype=torch.float32)
$182: f32[1, 116, 24, 64, 2] = torch._ops.aten.view.default($181, ['1', '116', '24', '-1', '2'])
$183: c64[1, 116, 24, 64] = torch._ops.aten.view_as_complex.default($182)
$184: c64[116, 1, 64] = torch._ops.aten.unsqueeze.default($175, 1)
$185: c64[1, 116, 24, 64] = torch._ops.aten.mul.Tensor($183, $184)
$186: f32[1, 116, 24, 64, 2] = torch._ops.aten.view_as_real.default($185)
$187: f32[1, 116, 24, 128] = torch._ops.aten.view.default($186, ['1', '116', '24', '128'])
$188: bf16[1, 116, 24, 128] = torch._ops.aten._to_copy.default($187, dtype=torch.bfloat16, layout=torch.strided, device=device(type='cuda', index=0))
$189: bf16[1, 6148, 24, 128] = torch._ops.aten.cat.default(['$180', '$163'], 1)
$190: bf16[1, 6148, 24, 128] = torch._ops.aten.cat.default(['$188', '$171'], 1)
$191: bf16[1, 6148, 24, 128] = torch._ops.aten.cat.default(['$86', '$83'], 1)
$192: bf16[1, 24, 6148, 128] = torch._ops.aten.permute.default($189, ['0', '2', '1', '3'])
$193: bf16[1, 24, 6148, 128] = torch._ops.aten.permute.default($190, ['0', '2', '1', '3'])
$194: bf16[1, 24, 6148, 128] = torch._ops.aten.permute.default($191, ['0', '2', '1', '3'])
$195: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($193)
$196: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($195)
$197: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($192)
$198: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($197)
$199: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($194)
$200: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($199)
('$201: bf16[1, 24, 6148, 128]', '$202: f32[1, 24, 6148]', 'None', 'None', '6148', '6148', '$203: u64[2]', '$204: u64[]', '$205: bf16[0]') = torch._ops.aten._scaled_dot_product_flash_attention.default($192, $193, $194, scale=0.08838834764831843)
$206: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($201)
$207: bf16[1, 24, 6148, 128] = torch._ops.aten.detach.default($206)
$208: bf16[1, 6148, 24, 128] = torch._ops.aten.permute.default($201, ['0', '2', '1', '3'])
$209: bf16[1, 6148, 3072] = torch._ops.aten.view.default($208, ['1', '6148', '3072'])
$210: bf16[1, 6148, 3072] = torch._ops.aten.slice.Tensor($209, 0, 0, 9223372036854775807)
$211: bf16[1, 116, 3072] = torch._ops.aten.slice.Tensor($210, 1, 0, 116)
$212: bf16[1, 116, 3072] = torch._ops.aten.slice.Tensor($211, 2, 0, 9223372036854775807)
$213: bf16[1, 6148, 3072] = torch._ops.aten.slice.Tensor($209, 0, 0, 9223372036854775807)
$214: bf16[1, 6032, 3072] = torch._ops.aten.slice.Tensor($213, 1, 116, 9223372036854775807)
$215: bf16[1, 6032, 3072] = torch._ops.aten.slice.Tensor($214, 2, 0, 9223372036854775807)
$216: bf16[6032, 3072] = torch._ops.aten.view.default($215, ['6032', '3072'])
$218: bf16[3072, 3072] = torch._ops.aten.t.default($217)
$220: bf16[6032, 3072] = torch._ops.aten.addmm.default($219, $216, $218)
$221: bf16[1, 6032, 3072] = torch._ops.aten.view.default($220, ['1', '6032', '3072'])
$222: bf16[116, 3072] = torch._ops.aten.view.default($212, ['116', '3072'])
$224: bf16[3072, 3072] = torch._ops.aten.t.default($223)
$226: bf16[116, 3072] = torch._ops.aten.addmm.default($225, $222, $224)
$227: bf16[1, 116, 3072] = torch._ops.aten.view.default($226, ['1', '116', '3072'])
$228: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($29, $221)
$229: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($15, $228)
$230: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($44, $227)
$231: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($30, $230)
$232: bf16[1, 6032, 3072] = torch._ops.aten.detach.default($229)
$233: bf16[1, 6032, 3072] = torch._ops.aten.detach.default($232)
('$234: bf16[1, 6032, 3072]', '$235: f32[1, 6032, 1]', '$236: f32[1, 6032, 1]') = torch._ops.aten.native_layer_norm.default($229, ['3072'], None, None, 1e-06)
['$237: bf16[1, 3072]', '$238: bf16[1, 3072]', '$239: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($12, 3072, -1)
$240: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($238, 1)
$241: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($240, 1)
$242: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($234, $241)
$243: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($237, 1)
$244: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($242, $243)
$245: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($239, 1)
$246: bf16[6032, 3072] = torch._ops.aten.view.default($244, ['6032', '3072'])
$248: bf16[3072, 12288] = torch._ops.aten.t.default($247)
$250: bf16[6032, 12288] = torch._ops.aten.addmm.default($249, $246, $248)
$251: bf16[1, 6032, 12288] = torch._ops.aten.view.default($250, ['1', '6032', '12288'])
$252: bf16[1, 6032, 12288] = torch._ops.aten.detach.default($251)
$253: bf16[1, 6032, 12288] = torch._ops.aten.detach.default($252)
$254: bf16[1, 6032, 12288] = torch._ops.aten.gelu.default($251, approximate='tanh')
$255: bf16[6032, 12288] = torch._ops.aten.view.default($254, ['6032', '12288'])
$257: bf16[12288, 3072] = torch._ops.aten.t.default($256)
$259: bf16[6032, 3072] = torch._ops.aten.addmm.default($258, $255, $257)
$260: bf16[1, 6032, 3072] = torch._ops.aten.view.default($259, ['1', '6032', '3072'])
$261: bf16[1, 6032, 3072] = torch._ops.aten.mul.Tensor($245, $260)
$262: bf16[1, 6032, 3072] = torch._ops.aten.add.Tensor($229, $261)
$263: bf16[1, 116, 3072] = torch._ops.aten.detach.default($231)
$264: bf16[1, 116, 3072] = torch._ops.aten.detach.default($263)
('$265: bf16[1, 116, 3072]', '$266: f32[1, 116, 1]', '$267: f32[1, 116, 1]') = torch._ops.aten.native_layer_norm.default($231, ['3072'], None, None, 1e-06)
['$268: bf16[1, 3072]', '$269: bf16[1, 3072]', '$270: bf16[1, 3072]'] = torch._ops.aten.split.Tensor($14, 3072, -1)
$271: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($269, 1)
$272: bf16[1, 1, 3072] = torch._ops.aten.add.Tensor($271, 1)
$273: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($265, $272)
$274: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($268, 1)
$275: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($273, $274)
$276: bf16[1, 1, 3072] = torch._ops.aten.unsqueeze.default($270, 1)
$277: bf16[116, 3072] = torch._ops.aten.view.default($275, ['116', '3072'])
$279: bf16[3072, 12288] = torch._ops.aten.t.default($278)
$281: bf16[116, 12288] = torch._ops.aten.addmm.default($280, $277, $279)
$282: bf16[1, 116, 12288] = torch._ops.aten.view.default($281, ['1', '116', '12288'])
$283: bf16[1, 116, 12288] = torch._ops.aten.detach.default($282)
$284: bf16[1, 116, 12288] = torch._ops.aten.detach.default($283)
$285: bf16[1, 116, 12288] = torch._ops.aten.gelu.default($282, approximate='tanh')
$286: bf16[116, 12288] = torch._ops.aten.view.default($285, ['116', '12288'])
$288: bf16[12288, 3072] = torch._ops.aten.t.default($287)
$290: bf16[116, 3072] = torch._ops.aten.addmm.default($289, $286, $288)
$291: bf16[1, 116, 3072] = torch._ops.aten.view.default($290, ['1', '116', '3072'])
$292: bf16[1, 116, 3072] = torch._ops.aten.mul.Tensor($276, $291)
$293: bf16[1, 116, 3072] = torch._ops.aten.add.Tensor($231, $292)

+------------------------------------------------------------------------------+
 ERROR: Detected non-determinism while running activation checkpointing

 You are seeing this error because you passed `debug=True` to checkpoint and
 tensors to be saved during the original forward and differ between those saved
 during recomputation. This can happen if different operators were ran in the
 original forward and in the recomputation.

 To identify where the mismatch may be coming from, you can do the following:

 1) Compare the operators ran during original forward and recomputation to
    see where they differ. These operators are printed above in the order they
    were executed.

 2) Review the stack trace for each operator to locate its invocation source.
    Each operator's stack trace is printed in their execution order.

 Note that the logs can be quite long. Here's how they are structured:
 (Tip: you can Ctrl-f for these headers)

 1. Stack traces of the operators that ran in the original forward
 2. Stack traces of the operators that ran during recomputation
 3. Log of operators in the original forward and recomputation
 4. Error message                                             <--- You are here
--------------------------------------------------------------------------------

